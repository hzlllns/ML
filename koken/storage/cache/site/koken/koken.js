!function(){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(e){setTimeout(e,16)}}(),void 0===jQuery.migrateMute&&(jQuery.migrateMute=!0),function(e,t,n){function r(n){var r=t.console;a[n]||(a[n]=!0,e.migrateWarnings.push(n),r&&r.warn&&!e.migrateMute&&(r.warn("JQMIGRATE: "+n),e.migrateTrace&&r.trace&&r.trace()))}function i(t,i,a,o){if(Object.defineProperty)try{return Object.defineProperty(t,i,{configurable:!0,enumerable:!0,get:function(){return r(o),a},set:function(e){r(o),a=e}}),n}catch(s){}e._definePropertyBroken=!0,t[i]=a}var a={};e.migrateWarnings=[],!e.migrateMute&&t.console&&t.console.log&&t.console.log("JQMIGRATE: Logging is active"),e.migrateTrace===n&&(e.migrateTrace=!0),e.migrateReset=function(){a={},e.migrateWarnings.length=0},"BackCompat"===document.compatMode&&r("jQuery is not compatible with Quirks Mode");var o=e("<input/>",{size:1}).attr("size")&&e.attrFn,s=e.attr,u=e.attrHooks.value&&e.attrHooks.value.get||function(){return null},c=e.attrHooks.value&&e.attrHooks.value.set||function(){return n},l=/^(?:input|button)$/i,d=/^[238]$/,f=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,p=/^(?:checked|selected)$/i;i(e,"attrFn",o||{},"jQuery.attrFn is deprecated"),e.attr=function(t,i,a,u){var c=i.toLowerCase(),m=t&&t.nodeType;return u&&(4>s.length&&r("jQuery.fn.attr( props, pass ) is deprecated"),t&&!d.test(m)&&(o?i in o:e.isFunction(e.fn[i])))?e(t)[i](a):("type"===i&&a!==n&&l.test(t.nodeName)&&t.parentNode&&r("Can't change the 'type' of an input or button in IE 6/7/8"),!e.attrHooks[c]&&f.test(c)&&(e.attrHooks[c]={get:function(t,r){var i,a=e.prop(t,r);return a===!0||"boolean"!=typeof a&&(i=t.getAttributeNode(r))&&i.nodeValue!==!1?r.toLowerCase():n},set:function(t,n,r){var i;return n===!1?e.removeAttr(t,r):(i=e.propFix[r]||r,i in t&&(t[i]=!0),t.setAttribute(r,r.toLowerCase())),r}},p.test(c)&&r("jQuery.fn.attr('"+c+"') may use property instead of attribute")),s.call(e,t,i,a))},e.attrHooks.value={get:function(e,t){var n=(e.nodeName||"").toLowerCase();return"button"===n?u.apply(this,arguments):("input"!==n&&"option"!==n&&r("jQuery.fn.attr('value') no longer gets properties"),t in e?e.value:null)},set:function(e,t){var i=(e.nodeName||"").toLowerCase();return"button"===i?c.apply(this,arguments):("input"!==i&&"option"!==i&&r("jQuery.fn.attr('value', val) no longer sets properties"),e.value=t,n)}};var m,h,g=e.fn.init,v=e.parseJSON,y=/^([^<]*)(<[\w\W]+>)([^>]*)$/;e.fn.init=function(t,n,i){var a;return t&&"string"==typeof t&&!e.isPlainObject(n)&&(a=y.exec(e.trim(t)))&&a[0]&&("<"!==t.charAt(0)&&r("$(html) HTML strings must start with '<' character"),a[3]&&r("$(html) HTML text after last tag is ignored"),"#"===a[0].charAt(0)&&(r("HTML string cannot start with a '#' character"),e.error("JQMIGRATE: Invalid selector string (XSS)")),n&&n.context&&(n=n.context),e.parseHTML)?g.call(this,e.parseHTML(a[2],n,!0),n,i):g.apply(this,arguments)},e.fn.init.prototype=e.fn,e.parseJSON=function(e){return e||null===e?v.apply(this,arguments):(r("jQuery.parseJSON requires a valid JSON string"),null)},e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||0>e.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e.browser||(m=e.uaMatch(navigator.userAgent),h={},m.browser&&(h[m.browser]=!0,h.version=m.version),h.chrome?h.webkit=!0:h.webkit&&(h.safari=!0),e.browser=h),i(e,"browser",e.browser,"jQuery.browser is deprecated"),e.sub=function(){function t(e,n){return new t.fn.init(e,n)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(r,i){return i&&i instanceof e&&!(i instanceof t)&&(i=t(i)),e.fn.init.call(this,r,i,n)},t.fn.init.prototype=t.fn;var n=t(document);return r("jQuery.sub() is deprecated"),t},e.ajaxSetup({converters:{"text json":e.parseJSON}});var w=e.fn.data;e.fn.data=function(t){var i,a,o=this[0];return!o||"events"!==t||1!==arguments.length||(i=e.data(o,t),a=e._data(o,t),i!==n&&i!==a||a===n)?w.apply(this,arguments):(r("Use of jQuery.fn.data('events') is deprecated"),a)};var b=/\/(java|ecma)script/i,x=e.fn.andSelf||e.fn.addBack;e.fn.andSelf=function(){return r("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),x.apply(this,arguments)},e.clean||(e.clean=function(t,i,a,o){i=i||document,i=!i.nodeType&&i[0]||i,i=i.ownerDocument||i,r("jQuery.clean() is deprecated");var s,u,c,l,d=[];if(e.merge(d,e.buildFragment(t,i).childNodes),a)for(c=function(e){return!e.type||b.test(e.type)?o?o.push(e.parentNode?e.parentNode.removeChild(e):e):a.appendChild(e):n},s=0;null!=(u=d[s]);s++)e.nodeName(u,"script")&&c(u)||(a.appendChild(u),u.getElementsByTagName!==n&&(l=e.grep(e.merge([],u.getElementsByTagName("script")),c),d.splice.apply(d,[s+1,0].concat(l)),s+=l.length));return d});var S=e.event.add,k=e.event.remove,j=e.event.trigger,F=e.fn.toggle,N=e.fn.live,C=e.fn.die,Q="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",T=RegExp("\\b(?:"+Q+")\\b"),M=/(?:^|\s)hover(\.\S+|)\b/,A=function(t){return"string"!=typeof t||e.event.special.hover?t:(M.test(t)&&r("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),t&&t.replace(M,"mouseenter$1 mouseleave$1"))};e.event.props&&"attrChange"!==e.event.props[0]&&e.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),e.event.dispatch&&i(e.event,"handle",e.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),e.event.add=function(e,t,n,i,a){e!==document&&T.test(t)&&r("AJAX events should be attached to document: "+t),S.call(this,e,A(t||""),n,i,a)},e.event.remove=function(e,t,n,r,i){k.call(this,e,A(t)||"",n,r,i)},e.fn.error=function(){var e=Array.prototype.slice.call(arguments,0);return r("jQuery.fn.error() is deprecated"),e.splice(0,0,"error"),arguments.length?this.bind.apply(this,e):(this.triggerHandler.apply(this,e),this)},e.fn.toggle=function(t,n){if(!e.isFunction(t)||!e.isFunction(n))return F.apply(this,arguments);r("jQuery.fn.toggle(handler, handler...) is deprecated");var i=arguments,a=t.guid||e.guid++,o=0,s=function(n){var r=(e._data(this,"lastToggle"+t.guid)||0)%o;return e._data(this,"lastToggle"+t.guid,r+1),n.preventDefault(),i[r].apply(this,arguments)||!1};for(s.guid=a;i.length>o;)i[o++].guid=a;return this.click(s)},e.fn.live=function(t,n,i){return r("jQuery.fn.live() is deprecated"),N?N.apply(this,arguments):(e(this.context).on(t,this.selector,n,i),this)},e.fn.die=function(t,n){return r("jQuery.fn.die() is deprecated"),C?C.apply(this,arguments):(e(this.context).off(t,this.selector||"**",n),this)},e.event.trigger=function(e,t,n,i){return n||T.test(e)||r("Global events are undocumented and deprecated"),j.call(this,e,t,n||document,i)},e.each(Q.split("|"),function(t,n){e.event.special[n]={setup:function(){var t=this;return t!==document&&(e.event.add(document,n+"."+e.guid,function(){e.event.trigger(n,null,t,!0)}),e._data(this,n,e.guid++)),!1},teardown:function(){return this!==document&&e.event.remove(document,n+"."+e._data(this,n)),!1}}})}(jQuery,window),function(){var e={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},t="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)e.supportsFullScreen=!0;else for(var n=0,r=t.length;r>n;n++)if(e.prefix=t[n],"undefined"!=typeof document[e.prefix+"CancelFullScreen"]){e.supportsFullScreen=!0;break}e.supportsFullScreen&&(e.fullScreenEventName=e.prefix+"fullscreenchange",e.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},e.requestFullScreen=function(e){return""===this.prefix?e.requestFullScreen():e[this.prefix+"RequestFullScreen"]()},e.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}),"undefined"!=typeof jQuery&&(jQuery.fn.requestFullScreen=function(){return this.each(function(){e.supportsFullScreen&&(e.isFullScreen()?e.cancelFullScreen(this):e.requestFullScreen(this))})}),window.fullScreenApi=e}(),function(e){"use strict";e.fn.fitVids=function(t){var n={customSelector:null},r=document.createElement("div"),i=document.getElementsByTagName("base")[0]||document.getElementsByTagName("script")[0];return r.className="fit-vids-style",r.innerHTML="&shy;<style>               .fluid-width-video-wrapper {                 width: 100%;                              position: relative;                       padding: 0;                            }                                                                                   .fluid-width-video-wrapper iframe,        .fluid-width-video-wrapper object,        .fluid-width-video-wrapper embed {           position: absolute;                       top: 0;                                   left: 0;                                  width: 100%;                              height: 100%;                          }                                       </style>",e(".fit-vids-style").length<=0&&i.parentNode.insertBefore(r,i),t&&e.extend(n,t),this.each(function(){var t=["iframe[src*='player.vimeo.com']","iframe[src*='www.youtube.com']","iframe[src*='www.youtube-nocookie.com']","iframe[src*='www.kickstarter.com']","iframe[src*='soundcloud.com']","object","embed"];n.customSelector&&t.push(n.customSelector);var r=e(this).find(t.join(","));r.each(function(){var t=e(this);if(!("embed"===this.tagName.toLowerCase()&&t.parent("object").length||t.parent(".fluid-width-video-wrapper").length)){var n="object"===this.tagName.toLowerCase()||t.attr("height")&&!isNaN(parseInt(t.attr("height"),10))?parseInt(t.attr("height"),10):t.height(),r=t.attr("width"),i=isNaN(parseInt(r,10))?t.width():parseInt(r,10),a=n/i;if(!t.attr("id")){var o="fitvid"+Math.floor(999999*Math.random());t.attr("id",o)}t.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*a+"%"),r&&t.parent(".fluid-width-video-wrapper").wrap('<div class="k-video max-width-video-wrapper"></div>').parent(".max-width-video-wrapper").css("max-width",r+"px"),t.removeAttr("height").removeAttr("width")}})})}}(jQuery),function(e){function t(e,t){for(var n=e.length;n--;)if(e[n]===t)return n;return-1}function n(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function r(e){for(w in x)x[w]=e[C[w]]}function i(e,n){var i,a,o,u,c;if(i=e.keyCode,-1==t(N,i)&&N.push(i),(93==i||224==i)&&(i=91),i in x){x[i]=!0;for(o in k)k[o]==i&&(s[o]=!0)}else if(r(e),s.filter.call(this,e)&&i in b)for(u=0;u<b[i].length;u++)if(a=b[i][u],a.scope==n||"all"==a.scope){c=a.mods.length>0;for(o in x)(!x[o]&&t(a.mods,+o)>-1||x[o]&&-1==t(a.mods,+o))&&(c=!1);(0==a.mods.length&&!x[16]&&!x[18]&&!x[17]&&!x[91]||c)&&a.method(e,a)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function a(e){var n,r=e.keyCode,i=t(N,r);if(i>=0&&N.splice(i,1),(93==r||224==r)&&(r=91),r in x){x[r]=!1;for(n in k)k[n]==r&&(s[n]=!1)}}function o(){for(w in x)x[w]=!1;for(w in k)s[w]=!1}function s(e,t,n){var r,i,a;for(r=h(e),void 0===n&&(n=t,t="all"),a=0;a<r.length;a++)i=[],e=r[a].split("+"),e.length>1&&(i=g(e),e=[e[e.length-1]]),e=e[0],e=F(e),e in b||(b[e]=[]),b[e].push({shortcut:r[a],scope:t,method:n,key:r[a],mods:i})}function u(e,t){var r,i,a=e.split("+"),o=[];if(a.length>1&&(o=g(a),e=a[a.length-1]),e=F(e),void 0===t&&(t=p()),b[e])for(r in b[e])i=b[e][r],i.scope===t&&n(i.mods,o)&&(b[e][r]={})}function c(e){return"string"==typeof e&&(e=F(e)),-1!=t(N,e)}function l(){return N.slice(0)}function d(e){var t=(e.target||e.srcElement).tagName;return"INPUT"!=t&&"SELECT"!=t&&"TEXTAREA"!=t}function f(e){S=e||"all"}function p(){return S||"all"}function m(e){var t,n,r;for(t in b)for(n=b[t],r=0;r<n.length;)n[r].scope===e?n.splice(r,1):r++}function h(e){var t;return e=e.replace(/\s/g,""),t=e.split(","),""==t[t.length-1]&&(t[t.length-2]+=","),t}function g(e){var t=e.slice(0,e.length-1);for(mi=0;mi<t.length;mi++)t[mi]=k[t[mi]];return t}function v(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,function(){n(window.event)})}function y(){var t=e.key;return e.key=Q,t}var w,b={},x={16:!1,18:!1,17:!1,91:!1},S="all",k={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},j={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},F=function(e){return j[e]||e.toUpperCase().charCodeAt(0)},N=[];for(w=1;20>w;w++)j["f"+w]=111+w;var C={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(w in k)s[w]=!1;v(document,"keydown",function(e){i(e,S)}),v(document,"keyup",a),v(window,"focus",o);var Q=e.key;e.key=s,e.key.setScope=f,e.key.getScope=p,e.key.deleteScope=m,e.key.filter=d,e.key.isPressed=c,e.key.getPressedKeyCodes=l,e.key.noConflict=y,e.key.unbind=u,"undefined"!=typeof module&&(module.exports=key)}(this),function(e){function t(e){return e}function n(e){return decodeURIComponent(e.replace(i," "))}function r(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a.json?JSON.parse(e):e}catch(t){}}var i=/\+/g,a=e.cookie=function(i,o,s){if(void 0!==o){if(s=e.extend({},a.defaults,s),"number"==typeof s.expires){var u=s.expires,c=s.expires=new Date;c.setDate(c.getDate()+u)}return o=a.json?JSON.stringify(o):String(o),document.cookie=[a.raw?i:encodeURIComponent(i),"=",a.raw?o:encodeURIComponent(o),s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":""].join("")}for(var l=a.raw?t:n,d=document.cookie.split("; "),f=i?void 0:{},p=0,m=d.length;m>p;p++){var h=d[p].split("="),g=l(h.shift()),v=l(h.join("="));if(i&&i===g){f=r(v);break}i||(f[g]=r(v))}return f};a.defaults={},e.removeCookie=function(t,n){return void 0!==e.cookie(t)?(e.cookie(t,"",e.extend(n,{expires:-1})),!0):!1}}(jQuery),function(e){function t(){var t=n(this);return isNaN(t.datetime)||e(this).text(r(t.datetime)),this}function n(t){if(t=e(t),!t.data("timeago")){t.data("timeago",{datetime:a.datetime(t)});var n=e.trim(t.text());n.length>0&&t.attr("title",n)}return t.data("timeago")}function r(e){return a.inWords(i(e))}function i(e){return(new Date).getTime()-e.getTime()}e.timeago=function(t){return t instanceof Date?r(t):"string"==typeof t?r(e.timeago.parse(t)):r(e.timeago.datetime(t))};var a=e.timeago;e.extend(e.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(t){function n(n,i){var a=e.isFunction(n)?n(i,t):n,o=r.numbers&&r.numbers[i]||i;return a.replace(/%d/i,o)}var r=this.settings.strings,i=r.prefixAgo,a=r.suffixAgo;this.settings.allowFuture&&0>t&&(i=r.prefixFromNow,a=r.suffixFromNow);var o=Math.abs(t)/1e3,s=o/60,u=s/60,c=u/24,l=c/365,d=45>o&&n(r.seconds,Math.round(o))||90>o&&n(r.minute,1)||45>s&&n(r.minutes,Math.round(s))||90>s&&n(r.hour,1)||24>u&&n(r.hours,Math.round(u))||42>u&&n(r.day,1)||30>c&&n(r.days,Math.round(c))||45>c&&n(r.month,1)||365>c&&n(r.months,Math.round(c/30))||1.5>l&&n(r.year,1)||n(r.years,Math.round(l));return e.trim([i,d,a].join(r.wordSeparator))},parse:function(t){var n=e.trim(t);return n=n.replace(/\.\d\d\d+/,""),n=n.replace(/-/,"/").replace(/-/,"/"),n=n.replace(/T/," ").replace(/Z/," UTC"),n=n.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(n)},datetime:function(t){var n="time"===e(t).get(0).tagName.toLowerCase(),r=n?e(t).attr("datetime"):e(t).attr("title");return a.parse(r)}}),e.fn.timeago=function(){var e=this;e.each(t);var n=a.settings;return n.refreshMillis>0&&setInterval(function(){e.each(t)},n.refreshMillis),e},document.createElement("abbr"),document.createElement("time")}(jQuery);!function(){window.$K={scrollContainer:!1,toggleFullScreen:function(t){var t=t||$(document.documentElement);t.requestFullScreen()},tgif:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",lightbox:{entryUrl:!1,overflow:"auto",entryTitle:!1,solo:!1,complete:function(t,e){document.title=e,location.href!==t&&window.history.replaceState(null,"",t)},cacheEntry:function(t,e){location.href.match(/lightbox\/$/)||(this.entryUrl=location.href,this.entryTitle=document.title,document.title=e,window.history.replaceState({lightboxEntry:!0},document.title),window.history.pushState(null,"",t))},load:function(t){$("body").addClass("k-lightbox-loading");var e={width:"100%",height:"100%",position:"fixed",zIndex:1e4,left:0,top:0,opacity:0};$("<iframe />").css(e).attr({src:t,id:"k-lightbox-iframe"}).on("load",function(){var t=this;requestAnimationFrame(function(){t.contentWindow.focus()})}).appendTo("body"),this.overflow=$("body").css("overflow"),$("body").css("overflow","hidden")},show:function(){$("body").removeClass("k-lightbox-loading"),$(".k-link-lightbox-loading").removeClass("k-link-lightbox-loading"),$(document).trigger("koken:lightbox:loaded"),$("#k-lightbox-iframe").animate({opacity:1},400,function(){$(".k-link-lightbox-loading").removeClass("k-link-lightbox-loading")})},exit:function(t){var e=$("#k-lightbox-iframe");e.length&&(t=t||!1,t||(this.entryUrl&&history.pushState(null,"",this.entryUrl),this.entryTitle&&(document.title=this.entryTitle)),$("body").css("overflow",this.overflow),$("#k-lightbox-iframe").animate({opacity:0},{duration:400,complete:function(){$(this).remove()}}))}},loadUrl:function(t){if($K.lightbox.entryUrl&&$K.lightbox.entryUrl===t)$K.lightbox.exit();else{var e=t.replace(RegExp("https?://"+location.host),""),i=$('a[href="'+e+'"]');window.Turbolinks&&window.Turbolinks.supported?Turbolinks.visit(e):!$K.location.draft&&$.pjax&&i.length?i.first().trigger("click"):location.href=t}},pulse:{plugins:{},groups:{},refs:{},overrides:{},teardown:function(){$.each(this.refs,function(t,e){e.kill()}),this.refs={}},register:function(t){this.refs[t.id]&&(this.refs[t.id].kill(),delete this.refs[t.id]);var e="#"+t.id,i=$(e).data("pulse-group");$(e).children(":not(div.cover)").remove(),this.groups[i]||(this.groups[i]=t.options);var n=this.groups[i],a=["width","height","dataUrl","data","next","previous","toggle","play","pause","fullscreen","restart"];return void 0===n.link_to&&a.push("link_to"),this.overrides[t.id]||(this.overrides[t.id]={}),$.each(a,$.proxy(function(e,i){t.options[i]&&(this.overrides[t.id][i]=t.options[i])},this)),this.refs[t.id]=Pulse(e,$.extend(n,this.overrides[t.id])),$.each(this.plugins,$.proxy(function(e){n[e+"_enabled"]&&this.refs[t.id][e](n)},this)),this.refs[t.id]}},navigation:{sets:[],init:!1,toggleChilds:function(t,e){var i=e&&"none"===e||$(t).hasClass("k-nav-open"),n=t.siblings("ul");n.length&&(i?$(t).removeClass("k-nav-open"):$(t).addClass("k-nav-open"),n.css("display",i?"none":"block"))},nest:function(){var t=$("a.k-nav-set");this.sets.length!==t.length&&(this.sets=t,$.each(this.sets,$.proxy(function(t,e){null===e.onclick&&(e.onclick=$.proxy(function(t){$(".k-nav-current").removeClass("k-nav-current"),this.toggleChilds($(e)),t.preventDefault()},this))},this)),this.setCurrent())},setCurrent:function(t){var e=RegExp("(https?://"+location.host+")?"+$K.location.root_folder+"(/(index|preview).php\\?)?"),t=t||location.href,i=t.replace(e,"").replace(/&rand=.*$/,"").replace(/&preview=.*/,"")||"/";$.each(this.sets,$.proxy(function(t,e){this.toggleChilds($(e),"none")},this)),$(".k-nav-current").removeClass("k-nav-current"),$.each($(".k-nav-root"),function(t,n){var a=!1,o={len:0,el:!1};$.each($(n).find("a:not(.k-nav-set)"),function(t,n){n=$(n);var r=n.attr("href").replace(e,"").replace(/&preview=.*/,"");if(i===r){for(n.addClass("k-nav-current");;){if(n=n.parent(),n.hasClass("k-nav-root"))break;"ul"===n.get(0).nodeName.toLowerCase()&&n.show()}return a=!0,!1}var s=RegExp("^"+r+"(.*)?$");r.length>1&&s.test(i)&&r.length>o.len&&(o.el=n,o.len=r.length)}),!a&&o.el&&o.el.addClass("k-nav-current")}),$('a[href="'+i+'"]').addClass("k-nav-current")}},keyboard:{bind:function(){$("[data-bind-to-key]").each(function(){var t=$(this),e=t.attr("data-bind-to-key");-1!==e.indexOf("→")&&(e=e.replace("→","right")),-1!==e.indexOf("←")&&(e=e.replace("←","left")),key.unbind(e),key(e,function(){var e=t.attr("href");if(!e||"#"===e)return t.trigger("click"),void 0;if(location.pathname!==e&&location.href!==e){var i=$._data(t.get(0),"events")&&$._data(t.get(0),"events").click;if(!i){var n=$._data(document,"events");n&&n.click&&$.each(n.click,function(e,n){return-1!==$.inArray(t.get(0),$(n.selector))?(i=!0,!1):void 0})}i&&void 0===t.attr("data-koken-internal")?t.trigger("click"):$K.loadUrl(e)}})})},scroll:{selector:!1,offset:0,index:0,move:function(t){var e=$(this.selector).filter(":visible"),i=!1,n=!1,a="function"==typeof this.offset?this.offset.call(this):this.offset,o=$(document).scrollTop(),r=$(window).height();return $.each(e,function(e,s){var l=$(s).offset().top;t?l+$(s).height()>o+r&&l>o-a?i=i?Math.min(i,l):l:!n&&l>o&&(n=l):o>l&&l>o-r?i=i?Math.min(i,l):l:o>l&&(n=l)}),!i&&n&&(i=n),t||i!==!1||(i=0),i!==!1&&$("html,body").animate({scrollTop:i+a}),!1},init:function(t,e){this.offset=e||0,this.selector=t,self=this,$(window).off(".kScroll").on("keydown.kScroll",function(t){-1!==$.inArray(t.which,[37,39])&&$K.keyboard.scroll.move(39===t.which)}),$(document).on("click","[data-koken-keyboard-scroll-previous]",function(){return $K.keyboard.scroll.move(!1),!1}),$(document).on("click","[data-koken-keyboard-scroll-next]",function(){return $K.keyboard.scroll.move(!0),!1})}}},lazy:{queue:[],working:[],fails:{},max:4,out:function(t){$K.lazy.working.splice($.inArray(t,$K.lazy.working),1),$K.lazy.worker()},fail:function(t){$K.lazy.fails[t]?$K.lazy.fails[t]++:$K.lazy.fails[t]=1,$K.lazy.fails[t]<3&&$K.lazy.queue.push(t),$K.lazy.out(t)},worker:function(){if($K.lazy.queue.length&&$K.lazy.working.length<$K.lazy.max){var t=$K.lazy.queue.shift(),e=$('img.k-lazy-loading[data-src="'+t+'"]').add('.k-lazy-loading-background[data-src="'+t+'"]'),i=new Image;if($K.lazy.fails[t]&&$K.lazy.fails[t]>2)return;$K.lazy.working.push(t),i.onerror=function(){$K.lazy.fail(t)},i.onload=function(){var i=e.filter("img"),n=e.filter(".k-lazy-loading-background");i.removeClass("k-lazy-loading"),n.removeClass("k-lazy-loading-background");var a=i.first().data("lazy-fade");a?i.css("opacity",.001):a=1;var o=n.first().data("lazy-fade");o&&n.each(function(){$(this).find("i.k-bg-fader").remove();var t=$(this).html();$(this).empty().css("position","relative"),$("<i/>").addClass("k-bg-fader").css({width:"100%",height:"100%","float":"left",backgroundPosition:$(this).css("background-position"),opacity:0,backgroundRepeat:"no-repeat",backgroundSize:"cover",zIndex:1}).appendTo($(this)),$("<span>").css({position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2}).html(t).appendTo($(this))}),setTimeout(function(){$K.lazy.out(t),i.attr("src",t),i.attr("data-src",null),i.each(function(){$(this).trigger("k-image-fading",$(this)),$(this).animate({opacity:1},a,function(){$(this).addClass("k-lazy-loaded"),$(this).trigger("k-image-loaded",$(this))})}),n.each(function(){$(this).addClass("k-lazy-background-loaded"),o?$(this).find("i.k-bg-fader").css("backgroundImage","url("+t+")").animate({opacity:1},o,function(){$(this).trigger("k-background-loaded")}):($(this).css("backgroundImage","url("+t+")"),$(this).trigger("k-background-loaded"))})},0)},i.src=t,$K.lazy.worker()}},load:function(){var t=1.3*$(window).height()+$(window).scrollTop(),e=2*$(window).width()+$(window).scrollLeft(),i=$("img.k-lazy-loading").add(".k-lazy-loading-background").filter(function(){return!$(this).attr("data-lazy-hold")&&$(this).attr("data-src")&&$(this).is(":visible")}).sort(function(t,e){var i=$(t).offset(),n=$(e).offset();return i.top===n.top?i.left>n.left?1:-1:i.top>n.top?1:-1});$K.lazy.queue=[],$.each(i,function(i,n){n=$(n);var a=n.offset();if(a.top<=t&&a.top+n.height()>=$(window).scrollTop()&&a.left<=e&&a.left+n.width()>=$(window).scrollLeft()){var o=n.attr("data-src");-1===$.inArray(o,$K.lazy.queue)&&$K.lazy.queue.push(o)}}),$K.lazy.worker()},initTimeout:null,init:function(){var t=$("img.k-lazy-loading"),e=$(".k-lazy-loading-background");t.length&&$.each(t,function(t,e){$(e).attr("src")!==$K.tgif&&$(e).attr("src",$K.tgif)}),(t.length||e.length)&&(clearTimeout(this.initTimeout),this.initTimeout=setTimeout(function(){$K.lazy.load()},250))}},isRetinaCache:null,isRetina:function(){return null!==this.isRetinaCache?this.isRetinaCache:(this.isRetinaCache=$K.retinaEnabled&&("devicePixelRatio"in window&&devicePixelRatio>1||"matchMedia"in window&&matchMedia("(min-resolution:144dpi)").matches),this.isRetinaCache)},retinafyUrl:function(t){return t=t.replace(".2x.","."),this.isRetina()&&(t=t.replace(/(\.\d{9,10})?\.[a-zA-Z]{3,4}$/,function(t){return".2x"+t})),t},layout:{mosaic:function(t){t=t||"ul.k-mosaic";var e=$(t);if(e.length){var i=function(){e.each(function(t,e){var i=e.className.match(/k-mosaic-(\d+)/)[1],n=$(e),a=n.children(),o=a.filter(":not(.k-mosaic-uneven)"),r=(o.length,a.length),s=r%i,l=n.width(),c=l/i,d=parseInt(a.first().css("margin-right"),10);if(a.css({width:Math.floor(c-(i-1)/i*d),height:c}),0!==s){var h=$($.makeArray(a).reverse().slice(0,s));d=Math.ceil((h.length-1)/h.length*d),h.addClass("k-mosaic-uneven").css({width:Math.min(l,Math.floor(l*(100/s)/100-d))})}var u=0,f=1;$.each(n.children(),function(t,e){u+=$(e).outerWidth(!0),f==i||r===t+1?(l>u&&$(e).width($(e).width()+(l-u)),u=0,f=1):f++})}),$K.responsiveBackgrounds(),$K.lazy.init()};$(window).on("k-resize",i),i()}}},loadImages:function(){var t=$("img[data-src]"),e=this;t.length&&$.each(t,function(t,i){var n=$(i),a=e.retinafyUrl(n.attr("data-src"));n.hasClass("k-lazy-loading")?n.attr("data-src",a):n.attr("src",a)})},resizeVideos:function(){$(".mejs-container video").each(function(){$v=$(this);var t=$v.data("aspect"),e=Math.min($v.parents(".mejs-container").parent().width(),$v.data("width")),i=e/t,n=this.player;if(n&&(n.setPlayerSize(e,i),n.setControlsSize()),"native"===this.pluginType){var a={width:e,height:i};$v.attr(a).css(a)}else n&&(n.options.videoWidth=e,n.options.videoHeight=i/t,n.media.setVideoSize&&n.media.setVideoSize(e,i))})},responsiveBackgrounds:function(){var t=$("[data-bg-presets]"),e=this;$.each(t,function(){var t,i=$(this),n=i.width(),a=i.height(),o=n/a,r=!1,s=/([a-z_\.]+)\,([0-9]+)\,([0-9]+)/g,l=i.data("bg-presets"),c=i.data("position")||"focal",d=i.css("background-image"),h=i.data("aspect"),u={backgroundRepeat:"no-repeat",backgroundSize:"cover"};if(0!==n&&0!==a){if("focal"===c){var f=i.data("focal-point").split(","),g=50,p=49;o>=h?p=f[1]:g=f[0],u.backgroundPosition=g+"% "+p+"%"}else u.backgroundPosition=c;for(;(t=s.exec(l))&&(r=e.retinafyUrl(i.data("base")+t[1]+"."+i.data("extension")),!(t[2]>=n&&t[3]>=a)););i.hasClass("k-lazy-loading-background")?i.attr("data-src",r):(r="url("+r+")",r&&r!==d&&(u.backgroundImage=r)),i.css(u)}})},responsiveImages:function(t,e){var i,n,a,o,r,s,l=t||$("img[data-presets]"),c=l.selector,d=(l.length,this),h=$.browser.msie||/Trident\/7\./.test(navigator.userAgent);$.each(l,function(t,e){e=$(e),"object"==typeof e.data("originalDom")&&(e=e.replaceWith(e.data("originalDom")),e.css("opacity",1))}),window.setTimeout(function(){var t=[],l=[],u=[],f=$(c),g=-1!==c.indexOf("data-responsive-hold");f=f.filter(function(){if(!(!g&&$(this).attr("data-responsive-hold")||$(this).parents("script").length||$(this).parents(".k-control-structure").length&&"none"===$(this).parents(".k-control-structure").first().css("display"))){var e=$(this).css(["display","visibility","width","height","paddingLeft","paddingRight","paddingTop","paddingBottom","maxHeight"]);if("none"!==e.display&&"hidden"!==e.visibility){t.push(e);for(var i=0,n=$(this);0===i;){n=n.parent();var a=n.css("display");if("none"===a)return!1;"inline"==a||n.attr("data-koken-ignore-responsive")||(i=n.width())}return u.push(i),l.push({el:n,w:n.width(),h:n.height(),css:n.css(["boxSizing"])}),!0}return!1}}),g&&f.attr("data-responsive-hold",null),$.each(f,function(e,c){c=$(c),$(document).trigger("k-img-resize-start",c),"object"==typeof c.data("originalDom")&&(c=c.replaceWith(c.data("originalDom")));var f=c.data("presets"),g=c.attr("src")||"",p=t.shift(),k=h||-1!==p.width.indexOf("%")?0:parseInt(p.width,10)||0,m=h||-1!==p.height.indexOf("%")?0:parseInt(p.height,10)||0,v=(parseInt(p.paddingLeft,10)||0)+(parseInt(p.paddingRight,10)||0),w=(parseInt(p.paddingTop,10)||0)+(parseInt(p.paddingBottom,10)||0),y=0,b=c,x=!0;if(k-=v,m-=w,10>k&&(k=0),10>m&&(m=0),leafObj=l.shift(),leafObj.el.length){b=leafObj.el,y=u.shift(),s=leafObj.css.boxSizing;var K=Math.max(m,leafObj.h),z=p.maxHeight,C=parseInt(z,10);-1!==z.indexOf("%")&&(C=K*(C/100)),c.data("originalDom")||(k>0&&k!==y?(c.data("originalDom",c.clone().attr({"data-lazy-hold":null})),y=Math.min(y,k)):c.data("originalDom","noreplace")),r=c.data("respond-to")||"width",isNaN(C)||(K=C,"width"===r&&(r=!1));var T,A=y/K,D=/([a-z_\.]+)\,([0-9]+)\,([0-9]+)/g,j=c.data("retain-aspect")||!1,_="1:1"===j;if(i=c.data("base"),n=c.data("extension"),c.attr("data-alt")&&(c.attr("alt",c.data("alt")),c.attr("data-alt",null)),j&&!_){var M=j.split(":");A=M[0]/M[1],K=Math.round(y/A),c.attr({width:y,height:K});var I=g.match(/\,(\d+)\./);if(I){var S=Math.abs(y-I[1])/I[1];if(I[1]>=y||.2>S)return}var U=Math.max(y,K),R={tiny:60,small:100,medium:480,medium_large:800,large:1024,xlarge:1600,huge:2048},O="",Y=!1;$.each(R,function(t,e){if(e>=U){var i=e-U;return(!Y||U-Y>i)&&(O=t),!1}O=t,Y=e}),O=$K.imageDefaults[O],g=i+y+"."+K+"."+O.quality+"."+Math.round(100*O.sharpening)+".crop."+n}else{for(var E=!1,P=!1,q=0,B=0;T=D.exec(f);)if(a=_||-1!==T[1].indexOf(".crop"),o=T[2]/T[3],E!==T[2]||P!==T[3]){if(g=i+(T[1].replace(/\.crop$/,"")+(a?".crop":""))+"."+n,E=P=!1,a){if("width"===r){if(T[2]>=y){B=y,q=y;break}}else if("height"===r||C){if(T[3]>=K){B=K,q=K;break}}else if(T[2]>=y&&T[3]>=K){B=Math.min(y,K),q=B;break}}else if("width"===r){if(T[2]>=y){B=y,q=y/o;break}}else if("height"===r){if(T[3]>=K){q=K,B=K*o;break}}else{if(o>=A&&T[2]>=y){B=y,q=y/o;break}if(A>o&&T[3]>=K){q=K,B=K*o;break}}E=T[2],P=T[3]}var U;U=T?Math.max(T[2],T[3]):Math.max(E,P),E&&("height"===r&&K>P&&(E=K*o,P=E/o),B=E,q=P),B>y&&"width"===r&&(B=y,q=y/o),x=!c.attr("data-longest-side")||c.attr("data-longest-side")<U;var F={"data-longest-side":U},L=function(t){return Math.round(Math.round(10*t)/10)};if(c.attr("width")!=B&&(F.width=L(B)),c.attr("height")!=q&&(F.height=L(q)),!F.width&&!F.height)return;c.attr(F)}g=d.retinafyUrl(g),g!==c.attr("src")&&x&&(c.hasClass("k-lazy-loading")||c.hasClass("k-lazy-loaded")?(c.removeClass("k-lazy-loaded"),c.addClass("k-lazy-loading"),c.attr("data-src",g),c.attr("src",$K.tgif),$(document).trigger("k-image-loading",c)):c.attr("src",g)),$(document).trigger("k-img-resize",c)}}),setTimeout(function(){$K.lazy.init(),$(window).trigger("k-resize"),e&&e.call(d)},1)},1)},infinity:{$target:[],isLoading:!1,bttn:!1,_paused:!1,pause:function(){this._paused=!0},resume:function(){this._paused=!1,this.init(),this.check()},next:function(){if(!$K.infinity._paused&&$K.infinity.$target.length&&$K.location.parameters.page<this.totalPages){$(window).trigger("k-infinite-loading"),$K.location.parameters.page++,this.isLoading=!0;var t=this,e=location.href.match(/&preview=.*/)||"";$.ajax({url:$K.location.root+$K.location.here.replace(/\/$/,"")+"/page/"+$K.location.parameters.page+"/"+e,success:function(e){$.each($(e).find(".k-infinite-load"),function(e,i){$(t.$target[e]).before($(i).children())}),t.isLoading=!1,$(window).trigger("k-infinite-loaded"),$K.ready(),t.check()}}),$K.location.parameters.page===this.totalPages&&this.bttn&&this.bttn.addClass("k-disabled")}},check:function(){if(!$K.infinity._paused&&this.$target.length&&!this.isLoading){var t=this.$target.first().siblings(":visible").last();t=t.children(":visible").length?t.children(":visible").last():t,t.length&&t.offset().top<$(window).scrollTop()+1.25*$(window).height()&&this.next()}},init:function(){if(!$K.infinity._paused&&!$K.infinity.$target.length){var t=$("span.k-infinite-load");if((t.length||$("br.k-infinite-marker").length)&&($.each(t,function(){$(this).append($("<br/>").css("display","none").addClass("k-infinite-marker")),$(this).replaceWith($(this).html())}),this.$target=$(".k-infinite-marker"),""!==this.selector)){var e=$(this.selector),i=this;this.bttn=e,e.length&&(this.totalPages>1?e.off("click").on("click",function(){i.next()}):e.remove())}}}},textPreview:function(t){var e=this.location.host+this.location.real_root_folder+"/admin/#/text/selection:"+t;$("<div/>").attr("id","k_essay_preview").html('You are previewing a draft of this essay. <a href="'+e+'" title="Return to the console">Go back and make edits</a>.').prependTo("body")},_prepDate:function(t){if(!t.utc){var e=new Date;return t.timestamp+60*e.getTimezoneOffset()}return t.timestamp},formattedDate:function(t){var e=this._prepDate(t);return this.date(this.dateFormats.date,e)},formattedTime:function(t){var e=this._prepDate(t);return this.date(this.dateFormats.time,e)},formattedDateTime:function(t){return this.formattedDate(t)+" "+this.formattedTime(t)},date:function(t,e){var i,n,a=this,o=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],r=/\\?(.?)/gi,s=function(t,e){return n[t]?n[t]():e},l=function(t,e){for(t=String(t);t.length<e;)t="0"+t;return t};return n={d:function(){return l(n.j(),2)},D:function(){return n.l().slice(0,3)},j:function(){return i.getDate()},l:function(){return o[n.w()]+"day"},N:function(){return n.w()||7},S:function(){var t=n.j(),e=t%10;return 3>=e&&1==parseInt(t%100/10,10)&&(e=0),["st","nd","rd"][e-1]||"th"},w:function(){return i.getDay()},z:function(){var t=new Date(n.Y(),n.n()-1,n.j()),e=new Date(n.Y(),0,1);return Math.round((t-e)/864e5)},W:function(){var t=new Date(n.Y(),n.n()-1,n.j()-n.N()+3),e=new Date(t.getFullYear(),0,4);return l(1+Math.round((t-e)/864e5/7),2)},F:function(){return o[6+n.n()]},m:function(){return l(n.n(),2)},M:function(){return n.F().slice(0,3)},n:function(){return i.getMonth()+1},t:function(){return new Date(n.Y(),n.n(),0).getDate()},L:function(){var t=n.Y();return t%4===0&t%100!==0|t%400===0},o:function(){var t=n.n(),e=n.W(),i=n.Y();return i+(12===t&&9>e?1:1===t&&e>9?-1:0)},Y:function(){return i.getFullYear()},y:function(){return n.Y().toString().slice(-2)},a:function(){return i.getHours()>11?"pm":"am"},A:function(){return n.a().toUpperCase()},B:function(){var t=3600*i.getUTCHours(),e=60*i.getUTCMinutes(),n=i.getUTCSeconds();return l(Math.floor((t+e+n+3600)/86.4)%1e3,3)},g:function(){return n.G()%12||12},G:function(){return i.getHours()},h:function(){return l(n.g(),2)},H:function(){return l(n.G(),2)},i:function(){return l(i.getMinutes(),2)},s:function(){return l(i.getSeconds(),2)},u:function(){return l(1e3*i.getMilliseconds(),6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var t=new Date(n.Y(),0),e=Date.UTC(n.Y(),0),i=new Date(n.Y(),6),a=Date.UTC(n.Y(),6);return t-e!==i-a?1:0},O:function(){var t=i.getTimezoneOffset(),e=Math.abs(t);return(t>0?"-":"+")+l(100*Math.floor(e/60)+e%60,4)},P:function(){var t=n.O();return t.substr(0,3)+":"+t.substr(3,2)},T:function(){return"UTC"},Z:function(){return 60*-i.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(r,s)},r:function(){return"D, d M Y H:i:s O".replace(r,s)},U:function(){return i/1e3|0}},this.date=function(t,e){return a=this,i=void 0===e?new Date:e instanceof Date?new Date(e):new Date(1e3*e),t.replace(r,s)},this.date(t,e)},ready:function(){$("noscript").remove(),$("time.k-relative-time").timeago(),$K.responsiveImages(),$K.responsiveBackgrounds(),$K.loadImages(),$K.lazy.init(),$K.navigation.nest(),$K.infinity.init(),$K.keyboard.bind(),$K.layout.mosaic(),$("img").off(".kjs").on("error.kjs",function(){var t=$(this),e=t.data("fails")||0;$K.lazy.working.splice($.inArray(t.attr("src"),$K.lazy.working),1),3>e&&(e++,t.attr("data-src")||t.attr("data-src",t.attr("src")),t.removeClass("k-lazy-loaded").addClass("k-lazy-loading"),setTimeout(function(){$K.lazy.init()},100),t.data("fails",e))}),$(window).off(".kjs");var t,e=$(window).add("body");$K.scrollContainer&&(e=e.add($($K.scrollContainer))),e.off(".kjs").on("scroll.kjs",function(){clearTimeout(t),t=setTimeout(function(){$K.lazy.load(),$K.infinity.bttn||$K.infinity.check(),$(window).trigger("k-scroll")},300)});var i;$(window).on("resize.kjs orientationchange.kjs",function(){$K.resizeVideos(),clearTimeout(i),i=setTimeout(function(){$K.responsiveImages(),$K.responsiveBackgrounds(),$(window).trigger("k-resize")},250);var t=$("#k-lightbox-iframe");t.length&&$(t.get(0).contentDocument).find("html, body").height($(window).height())}),$K.infinity.bttn||$K.infinity.check(),$("body").fitVids(),$(".k-content-embed iframe").show(),$(".k-select").off("change").on("change",function(){"__label__"!==$(this).val()&&$K.loadUrl($K.location.root+$(this).val()+($K.location.preview?"&preview="+$K.location.preview:""))});var n=RegExp("https?://"+location.host+$K.location.root_folder+"(/(index|preview).php\\?)?"),a=document.referrer.replace(n,"");if(/^https?:/.test(a)&&(a=!1),$K.location.urls.album){var o=RegExp($K.location.urls.album.replace(/:[a-z_]+/,"[^/]+")+"/lightbox/?$");o.test(a)&&(a=a.replace(/\/lightbox\/?$/,""))}/\/lightbox\/?$/.test(a)&&$.cookie("koken_referrer")?a=$.cookie("koken_referrer"):/\/lightbox\/?$/.test(a)||$.cookie("koken_referrer",a,{path:"/"}),$K.location.referrer=a,$(document).trigger("k-ready")}},$(document).ready(function(){function t(){var t=$("body").attr("class")||"";$("body").attr("class",t.replace(/k\-source\-([^\s]+)(\sk\-lens\-([^\s]+))?/,$K.location.page_class));var t=$("html").attr("class")||"";$("html").attr("class",t.replace(/k\-source\-([^\s]+)(\sk\-lens\-([^\s]+))?/,$K.location.page_class)),$K.navigation.setCurrent()}window.Turbolinks&&window.Turbolinks.supported||$K.ready(),$(window).on("popstate",function(t){return $K.lightbox.solo?!0:(t.originalEvent.state&&t.originalEvent.state.lightboxEntry?($K.lightbox.entryUrl=!1,$K.lightbox.exit()):window===window.top&&location.href.match(/\/lightbox\/$/)&&($("#k-lightbox-iframe").length||$K.lightbox.load(location.href)),void 0)}),$(document).on("click","a",function(t){if($(this).attr("href").match(/\/lightbox\/(&preview=.*)?$/)&&!location.href.match(/\/lightbox\//)&&(t.preventDefault(),$(this).addClass("k-link-lightbox-loading"),$(document).trigger("koken:lightbox:loading",this),$K.lightbox.load($(this).attr("href"))),$(this).attr("data-koken-share")){var e=$(this).attr("data-koken-share");if("twitter"!==e||-1===document.location.href.indexOf("preview.php")){t.preventDefault();var i={pinterest:320,"google-plus":400,twitter:256},n=560,a=i[e]||450,o=window.screen.height/2-(a/2+50),r=window.screen.width/2-(n/2+10);window.open($(this).attr("href"),"_blank","top="+o+",left="+r+",width="+n+",height="+a)}}}),$(window).on("k-pjax-end",function(){t()}),$(window).on("pjax:transition:start pjax:transition:restore pjax:end",function(t){$.pjaxTransition&&"pjax:end"===t.type||($K.ready(),$K.navigation.setCurrent())}),$(window).on("pjax:transition:end",function(){$("body").fitVids()});var e=$.extend({},$K.location);$(document).on("pjax:send",function(){e=$.extend({},$K.location)}),$(window).on("pjax:transition:beforeRestore",function(){var i=$.extend({},$K.location);$K.location=$.extend({},e,{parameters:{page:1}}),e=i,t()}),$(document).on("page:fetch pjax:start",function(){$(".mejs-container video").each(function(){0===$(this).parents("#pjax-container-staging").length&&(this.player.remove(),$(this).remove())}),$K.lazy.queue=[],$K.infinity.$target=[],$K.pulse.teardown(),$K.lightbox.exit(!0),$(document).trigger("k-page-fetch")}),$(document).on("page:change",function(){$K.ready(),$(document).trigger("k-page-change")}),$(document).on("page:restore",function(){$(document).trigger("k-page-restore")})})}();$K.location = {"root":"\/koken","root_folder":"\/koken","real_root_folder":"\/koken","rewrite":true,"host":"http:\/\/marissalargo.com","hostname":"marissalargo.com","site_url":"http:\/\/marissalargo.com\/koken","preview":false,"draft":false,"theme_path":"\/koken\/storage\/themes\/largo2","urls":{"content":"\/content\/:slug\/","tag_content":"\/tags\/:tag_slug\/content\/:slug\/","category_content":"\/categories\/:category_slug\/content\/:slug\/","favorite":"\/favorites\/:slug\/","feature":"\/features\/:slug\/","archive_contents":"\/content\/:year(?:\/:month(?:\/:day)?)?\/","tag_contents":"\/tags\/:slug\/content\/","category_contents":"\/categories\/:slug\/content\/","contents":"\/content\/","favorites":"\/favorites\/","album":"\/projects\/:slug\/","tag_album":"\/tags\/:tag_slug\/projects\/:slug\/","category_album":"\/categories\/:category_slug\/projects\/:slug\/","archive_albums":"\/projects\/:year(?:\/:month(?:\/:day)?)?\/","tag_albums":"\/tags\/:slug\/projects\/","category_albums":"\/categories\/:slug\/projects\/","albums":"\/projects\/","set":"\/sets\/:slug\/","sets":"\/sets\/","essay":"\/news\/:year\/:month\/:slug\/","tag_essay":"\/tags\/:tag_slug\/news\/:slug\/","category_essay":"\/categories\/:category_slug\/news\/:slug\/","archive_essays":"\/news\/:year(?:\/:month(?:\/:day)?)?\/","tag_essays":"\/tags\/:slug\/news\/","category_essays":"\/categories\/:slug\/news\/","essays":"\/news\/","page":"\/pages\/:slug\/","tag":"\/tags\/:slug\/","tags":"\/tags\/","category":"\/categories\/:slug\/","categories":"\/categories\/","timeline":"\/timeline\/","archive_timeline":"\/timeline\/:year(?:\/:month)?\/","event_timeline":"\/timeline\/:year\/:month\/:day\/"}};$K.lazy.max = 4;$K.imageDefaults = {"tiny":{"quality":"80","sharpening":"0.7"},"small":{"quality":"80","sharpening":"0.6"},"medium":{"quality":"85","sharpening":"0.6"},"medium_large":{"quality":"85","sharpening":"0.6"},"large":{"quality":"85","sharpening":"0.6"},"xlarge":{"quality":"90","sharpening":"0.3"},"huge":{"quality":"90","sharpening":"0"}};$K.theme = 'largo2';$K.retinaEnabled = true;
$K.dateFormats = { date: "F j, Y", time: "g:i a" };/*!
* MediaElement.js
* HTML5 <video> and <audio> shim and player
* http://mediaelementjs.com/
*
* Creates a JavaScript object that mimics HTML5 MediaElement API
* for browsers that don't understand HTML5 or can't play the provided codec
* Can play MP4 (H.264), Ogg, WebM, FLV, WMV, WMA, ACC, and MP3
*
* Copyright 2010-2013, John Dyer (http://j.hn)
* License: MIT
*
*/var mejs=mejs||{};mejs.version="2.13.1";mejs.meIndex=0;
mejs.plugins={silverlight:[{version:[3,0],types:["video/mp4","video/m4v","video/mov","video/wmv","audio/wma","audio/m4a","audio/mp3","audio/wav","audio/mpeg"]}],flash:[{version:[9,0,124],types:["video/mp4","video/m4v","video/mov","video/flv","video/rtmp","video/x-flv","audio/flv","audio/x-flv","audio/mp3","audio/m4a","audio/mpeg","video/youtube","video/x-youtube"]}],youtube:[{version:null,types:["video/youtube","video/x-youtube","audio/youtube","audio/x-youtube"]}],vimeo:[{version:null,types:["video/vimeo",
"video/x-vimeo"]}]};
mejs.Utility={encodeUrl:function(a){return encodeURIComponent(a)},escapeHTML:function(a){return a.toString().split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")},absolutizeUrl:function(a){var b=document.createElement("div");b.innerHTML='<a href="'+this.escapeHTML(a)+'">x</a>';return b.firstChild.href},getScriptPath:function(a){for(var b=0,c,d="",e="",f,g,h=document.getElementsByTagName("script"),l=h.length,j=a.length;b<l;b++){f=h[b].src;c=f.lastIndexOf("/");if(c>-1){g=f.substring(c+
1);f=f.substring(0,c+1)}else{g=f;f=""}for(c=0;c<j;c++){e=a[c];e=g.indexOf(e);if(e>-1){d=f;break}}if(d!=="")break}return d},secondsToTimeCode:function(a,b,c,d){if(typeof c=="undefined")c=false;else if(typeof d=="undefined")d=25;var e=Math.floor(a/3600)%24,f=Math.floor(a/60)%60,g=Math.floor(a%60);a=Math.floor((a%1*d).toFixed(3));return(b||e>0?(e<10?"0"+e:e)+":":"")+(f<10?"0"+f:f)+":"+(g<10?"0"+g:g)+(c?":"+(a<10?"0"+a:a):"")},timeCodeToSeconds:function(a,b,c,d){if(typeof c=="undefined")c=false;else if(typeof d==
"undefined")d=25;a=a.split(":");b=parseInt(a[0],10);var e=parseInt(a[1],10),f=parseInt(a[2],10),g=0,h=0;if(c)g=parseInt(a[3])/d;return h=b*3600+e*60+f+g},convertSMPTEtoSeconds:function(a){if(typeof a!="string")return false;a=a.replace(",",".");var b=0,c=a.indexOf(".")!=-1?a.split(".")[1].length:0,d=1;a=a.split(":").reverse();for(var e=0;e<a.length;e++){d=1;if(e>0)d=Math.pow(60,e);b+=Number(a[e])*d}return Number(b.toFixed(c))},removeSwf:function(a){var b=document.getElementById(a);if(b&&/object|embed/i.test(b.nodeName))if(mejs.MediaFeatures.isIE){b.style.display=
"none";(function(){b.readyState==4?mejs.Utility.removeObjectInIE(a):setTimeout(arguments.callee,10)})()}else b.parentNode.removeChild(b)},removeObjectInIE:function(a){if(a=document.getElementById(a)){for(var b in a)if(typeof a[b]=="function")a[b]=null;a.parentNode.removeChild(a)}}};
mejs.PluginDetector={hasPluginVersion:function(a,b){var c=this.plugins[a];b[1]=b[1]||0;b[2]=b[2]||0;return c[0]>b[0]||c[0]==b[0]&&c[1]>b[1]||c[0]==b[0]&&c[1]==b[1]&&c[2]>=b[2]?true:false},nav:window.navigator,ua:window.navigator.userAgent.toLowerCase(),plugins:[],addPlugin:function(a,b,c,d,e){this.plugins[a]=this.detectPlugin(b,c,d,e)},detectPlugin:function(a,b,c,d){var e=[0,0,0],f;if(typeof this.nav.plugins!="undefined"&&typeof this.nav.plugins[a]=="object"){if((c=this.nav.plugins[a].description)&&
!(typeof this.nav.mimeTypes!="undefined"&&this.nav.mimeTypes[b]&&!this.nav.mimeTypes[b].enabledPlugin)){e=c.replace(a,"").replace(/^\s+/,"").replace(/\sr/gi,".").split(".");for(a=0;a<e.length;a++)e[a]=parseInt(e[a].match(/\d+/),10)}}else if(typeof window.ActiveXObject!="undefined")try{if(f=new ActiveXObject(c))e=d(f)}catch(g){}return e}};
mejs.PluginDetector.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",function(a){var b=[];if(a=a.GetVariable("$version")){a=a.split(" ")[1].split(",");b=[parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],10)]}return b});
mejs.PluginDetector.addPlugin("silverlight","Silverlight Plug-In","application/x-silverlight-2","AgControl.AgControl",function(a){var b=[0,0,0,0],c=function(d,e,f,g){for(;d.isVersionSupported(e[0]+"."+e[1]+"."+e[2]+"."+e[3]);)e[f]+=g;e[f]-=g};c(a,b,0,1);c(a,b,1,1);c(a,b,2,1E4);c(a,b,2,1E3);c(a,b,2,100);c(a,b,2,10);c(a,b,2,1);c(a,b,3,1);return b});
mejs.MediaFeatures={init:function(){var a=this,b=document,c=mejs.PluginDetector.nav,d=mejs.PluginDetector.ua.toLowerCase(),e,f=["source","track","audio","video"];a.isiPad=d.match(/ipad/i)!==null;a.isiPhone=d.match(/iphone/i)!==null;a.isiOS=a.isiPhone||a.isiPad;a.isAndroid=d.match(/android/i)!==null;a.isBustedAndroid=d.match(/android 2\.[12]/)!==null;a.isBustedNativeHTTPS=location.protocol==="https:"&&(d.match(/android [12]\./)!==null||d.match(/macintosh.* version.* safari/)!==null);a.isIE=c.appName.toLowerCase().match(/trident/gi)!==
null;a.isChrome=d.match(/chrome/gi)!==null;a.isFirefox=d.match(/firefox/gi)!==null;a.isWebkit=d.match(/webkit/gi)!==null;a.isGecko=d.match(/gecko/gi)!==null&&!a.isWebkit&&!a.isIE;a.isOpera=d.match(/opera/gi)!==null;a.hasTouch="ontouchstart"in window&&window.ontouchstart!=null;a.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;for(c=0;c<f.length;c++)e=document.createElement(f[c]);a.supportsMediaTag=typeof e.canPlayType!=="undefined"||a.isBustedAndroid;
try{e.canPlayType("video/mp4")}catch(g){a.supportsMediaTag=false}a.hasSemiNativeFullScreen=typeof e.webkitEnterFullscreen!=="undefined";a.hasNativeFullscreen=typeof e.requestFullscreen!=="undefined";a.hasWebkitNativeFullScreen=typeof e.webkitRequestFullScreen!=="undefined";a.hasMozNativeFullScreen=typeof e.mozRequestFullScreen!=="undefined";a.hasMsNativeFullScreen=typeof e.msRequestFullscreen!=="undefined";a.hasTrueNativeFullScreen=a.hasWebkitNativeFullScreen||a.hasMozNativeFullScreen||a.hasMsNativeFullScreen;
a.nativeFullScreenEnabled=a.hasTrueNativeFullScreen;if(a.hasMozNativeFullScreen)a.nativeFullScreenEnabled=document.mozFullScreenEnabled;else if(a.hasMsNativeFullScreen)a.nativeFullScreenEnabled=document.msFullscreenEnabled;if(a.isChrome)a.hasSemiNativeFullScreen=false;if(a.hasTrueNativeFullScreen){a.fullScreenEventName="";if(a.hasWebkitNativeFullScreen)a.fullScreenEventName="webkitfullscreenchange";else if(a.hasMozNativeFullScreen)a.fullScreenEventName="mozfullscreenchange";else if(a.hasMsNativeFullScreen)a.fullScreenEventName=
"MSFullscreenChange";a.isFullScreen=function(){if(e.mozRequestFullScreen)return b.mozFullScreen;else if(e.webkitRequestFullScreen)return b.webkitIsFullScreen;else if(e.hasMsNativeFullScreen)return b.msFullscreenElement!==null};a.requestFullScreen=function(h){if(a.hasWebkitNativeFullScreen)h.webkitRequestFullScreen();else if(a.hasMozNativeFullScreen)h.mozRequestFullScreen();else a.hasMsNativeFullScreen&&h.msRequestFullscreen()};a.cancelFullScreen=function(){if(a.hasWebkitNativeFullScreen)document.webkitCancelFullScreen();
else if(a.hasMozNativeFullScreen)document.mozCancelFullScreen();else a.hasMsNativeFullScreen&&document.msExitFullscreen()}}if(a.hasSemiNativeFullScreen&&d.match(/mac os x 10_5/i)){a.hasNativeFullScreen=false;a.hasSemiNativeFullScreen=false}}};mejs.MediaFeatures.init();
mejs.HtmlMediaElement={pluginType:"native",isFullScreen:false,setCurrentTime:function(a){this.currentTime=a},setMuted:function(a){this.muted=a},setVolume:function(a){this.volume=a},stop:function(){this.pause()},setSrc:function(a){for(var b=this.getElementsByTagName("source");b.length>0;)this.removeChild(b[0]);if(typeof a=="string")this.src=a;else{var c;for(b=0;b<a.length;b++){c=a[b];if(this.canPlayType(c.type)){this.src=c.src;break}}}},setVideoSize:function(a,b){this.width=a;this.height=b}};
mejs.PluginMediaElement=function(a,b,c){this.id=a;this.pluginType=b;this.src=c;this.events={};this.attributes={}};
mejs.PluginMediaElement.prototype={pluginElement:null,pluginType:"",isFullScreen:false,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:true,ended:false,seeking:false,duration:0,error:null,tagName:"",muted:false,volume:1,currentTime:0,play:function(){if(this.pluginApi!=null){this.pluginType=="youtube"?this.pluginApi.playVideo():this.pluginApi.playMedia();this.paused=false}},load:function(){if(this.pluginApi!=null){this.pluginType!="youtube"&&this.pluginApi.loadMedia();this.paused=
false}},pause:function(){if(this.pluginApi!=null){this.pluginType=="youtube"?this.pluginApi.pauseVideo():this.pluginApi.pauseMedia();this.paused=true}},stop:function(){if(this.pluginApi!=null){this.pluginType=="youtube"?this.pluginApi.stopVideo():this.pluginApi.stopMedia();this.paused=true}},canPlayType:function(a){var b,c,d,e=mejs.plugins[this.pluginType];for(b=0;b<e.length;b++){d=e[b];if(mejs.PluginDetector.hasPluginVersion(this.pluginType,d.version))for(c=0;c<d.types.length;c++)if(a==d.types[c])return"probably"}return""},
positionFullscreenButton:function(a,b,c){this.pluginApi!=null&&this.pluginApi.positionFullscreenButton&&this.pluginApi.positionFullscreenButton(Math.floor(a),Math.floor(b),c)},hideFullscreenButton:function(){this.pluginApi!=null&&this.pluginApi.hideFullscreenButton&&this.pluginApi.hideFullscreenButton()},setSrc:function(a){if(typeof a=="string"){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(a));this.src=mejs.Utility.absolutizeUrl(a)}else{var b,c;for(b=0;b<a.length;b++){c=a[b];if(this.canPlayType(c.type)){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(c.src));
this.src=mejs.Utility.absolutizeUrl(a);break}}}},setCurrentTime:function(a){if(this.pluginApi!=null){this.pluginType=="youtube"?this.pluginApi.seekTo(a):this.pluginApi.setCurrentTime(a);this.currentTime=a}},setVolume:function(a){if(this.pluginApi!=null){this.pluginType=="youtube"?this.pluginApi.setVolume(a*100):this.pluginApi.setVolume(a);this.volume=a}},setMuted:function(a){if(this.pluginApi!=null){if(this.pluginType=="youtube"){a?this.pluginApi.mute():this.pluginApi.unMute();this.muted=a;this.dispatchEvent("volumechange")}else this.pluginApi.setMuted(a);
this.muted=a}},setVideoSize:function(a,b){if(this.pluginElement.style){this.pluginElement.style.width=a+"px";this.pluginElement.style.height=b+"px"}this.pluginApi!=null&&this.pluginApi.setVideoSize&&this.pluginApi.setVideoSize(a,b)},setFullscreen:function(a){this.pluginApi!=null&&this.pluginApi.setFullscreen&&this.pluginApi.setFullscreen(a)},enterFullScreen:function(){this.pluginApi!=null&&this.pluginApi.setFullscreen&&this.setFullscreen(true)},exitFullScreen:function(){this.pluginApi!=null&&this.pluginApi.setFullscreen&&
this.setFullscreen(false)},addEventListener:function(a,b){this.events[a]=this.events[a]||[];this.events[a].push(b)},removeEventListener:function(a,b){if(!a){this.events={};return true}var c=this.events[a];if(!c)return true;if(!b){this.events[a]=[];return true}for(i=0;i<c.length;i++)if(c[i]===b){this.events[a].splice(i,1);return true}return false},dispatchEvent:function(a){var b,c,d=this.events[a];if(d){c=Array.prototype.slice.call(arguments,1);for(b=0;b<d.length;b++)d[b].apply(null,c)}},hasAttribute:function(a){return a in
this.attributes},removeAttribute:function(a){delete this.attributes[a]},getAttribute:function(a){if(this.hasAttribute(a))return this.attributes[a];return""},setAttribute:function(a,b){this.attributes[a]=b},remove:function(){mejs.Utility.removeSwf(this.pluginElement.id);mejs.MediaPluginBridge.unregisterPluginElement(this.pluginElement.id)}};
mejs.MediaPluginBridge={pluginMediaElements:{},htmlMediaElements:{},registerPluginElement:function(a,b,c){this.pluginMediaElements[a]=b;this.htmlMediaElements[a]=c},unregisterPluginElement:function(a){delete this.pluginMediaElements[a];delete this.htmlMediaElements[a]},initPlugin:function(a){var b=this.pluginMediaElements[a],c=this.htmlMediaElements[a];if(b){switch(b.pluginType){case "flash":b.pluginElement=b.pluginApi=document.getElementById(a);break;case "silverlight":b.pluginElement=document.getElementById(b.id);
b.pluginApi=b.pluginElement.Content.MediaElementJS}b.pluginApi!=null&&b.success&&b.success(b,c)}},fireEvent:function(a,b,c){var d,e;if(a=this.pluginMediaElements[a]){b={type:b,target:a};for(d in c){a[d]=c[d];b[d]=c[d]}e=c.bufferedTime||0;b.target.buffered=b.buffered={start:function(){return 0},end:function(){return e},length:1};a.dispatchEvent(b.type,b)}}};
mejs.MediaElementDefaults={mode:"auto",plugins:["flash","silverlight","youtube","vimeo"],enablePluginDebug:false,httpsBasicAuthSite:false,type:"",pluginPath:mejs.Utility.getScriptPath(["mediaelement.js","mediaelement.min.js","mediaelement-and-player.js","mediaelement-and-player.min.js"]),flashName:"flashmediaelement.swf",flashStreamer:"",enablePluginSmoothing:false,enablePseudoStreaming:false,pseudoStreamingStartQueryParam:"start",silverlightName:"silverlightmediaelement.xap",defaultVideoWidth:480,
defaultVideoHeight:270,pluginWidth:-1,pluginHeight:-1,pluginVars:[],timerRate:250,startVolume:0.8,success:function(){},error:function(){}};mejs.MediaElement=function(a,b){return mejs.HtmlMediaElementShim.create(a,b)};
mejs.HtmlMediaElementShim={create:function(a,b){var c=mejs.MediaElementDefaults,d=typeof a=="string"?document.getElementById(a):a,e=d.tagName.toLowerCase(),f=e==="audio"||e==="video",g=f?d.getAttribute("src"):d.getAttribute("href");e=d.getAttribute("poster");var h=d.getAttribute("autoplay"),l=d.getAttribute("preload"),j=d.getAttribute("controls"),k;for(k in b)c[k]=b[k];g=typeof g=="undefined"||g===null||g==""?null:g;e=typeof e=="undefined"||e===null?"":e;l=typeof l=="undefined"||l===null||l==="false"?
"none":l;h=!(typeof h=="undefined"||h===null||h==="false");j=!(typeof j=="undefined"||j===null||j==="false");k=this.determinePlayback(d,c,mejs.MediaFeatures.supportsMediaTag,f,g);k.url=k.url!==null?mejs.Utility.absolutizeUrl(k.url):"";if(k.method=="native"){if(mejs.MediaFeatures.isBustedAndroid){d.src=k.url;d.addEventListener("click",function(){d.play()},false)}return this.updateNative(k,c,h,l)}else if(k.method!=="")return this.createPlugin(k,c,e,h,l,j);else{this.createErrorMessage(k,c,e);return this}},
determinePlayback:function(a,b,c,d,e){var f=[],g,h,l,j={method:"",url:"",htmlMediaElement:a,isVideo:a.tagName.toLowerCase()!="audio"},k;if(typeof b.type!="undefined"&&b.type!=="")if(typeof b.type=="string")f.push({type:b.type,url:e});else for(g=0;g<b.type.length;g++)f.push({type:b.type[g],url:e});else if(e!==null){l=this.formatType(e,a.getAttribute("type"));f.push({type:l,url:e})}else for(g=0;g<a.childNodes.length;g++){h=a.childNodes[g];if(h.nodeType==1&&h.tagName.toLowerCase()=="source"){e=h.getAttribute("src");
l=this.formatType(e,h.getAttribute("type"));h=h.getAttribute("media");if(!h||!window.matchMedia||window.matchMedia&&window.matchMedia(h).matches)f.push({type:l,url:e})}}if(!d&&f.length>0&&f[0].url!==null&&this.getTypeFromFile(f[0].url).indexOf("audio")>-1)j.isVideo=false;if(mejs.MediaFeatures.isBustedAndroid)a.canPlayType=function(m){return m.match(/video\/(mp4|m4v)/gi)!==null?"maybe":""};if(c&&(b.mode==="auto"||b.mode==="auto_plugin"||b.mode==="native")&&!(mejs.MediaFeatures.isBustedNativeHTTPS&&
b.httpsBasicAuthSite===true)){if(!d){g=document.createElement(j.isVideo?"video":"audio");a.parentNode.insertBefore(g,a);a.style.display="none";j.htmlMediaElement=a=g}for(g=0;g<f.length;g++)if(a.canPlayType(f[g].type).replace(/no/,"")!==""||a.canPlayType(f[g].type.replace(/mp3/,"mpeg")).replace(/no/,"")!==""){j.method="native";j.url=f[g].url;break}if(j.method==="native"){if(j.url!==null)a.src=j.url;if(b.mode!=="auto_plugin")return j}}if(b.mode==="auto"||b.mode==="auto_plugin"||b.mode==="shim")for(g=
0;g<f.length;g++){l=f[g].type;for(a=0;a<b.plugins.length;a++){e=b.plugins[a];h=mejs.plugins[e];for(c=0;c<h.length;c++){k=h[c];if(k.version==null||mejs.PluginDetector.hasPluginVersion(e,k.version))for(d=0;d<k.types.length;d++)if(l==k.types[d]){j.method=e;j.url=f[g].url;return j}}}}if(b.mode==="auto_plugin"&&j.method==="native")return j;if(j.method===""&&f.length>0)j.url=f[0].url;return j},formatType:function(a,b){return a&&!b?this.getTypeFromFile(a):b&&~b.indexOf(";")?b.substr(0,b.indexOf(";")):b},
getTypeFromFile:function(a){a=a.split("?")[0];a=a.substring(a.lastIndexOf(".")+1).toLowerCase();return(/(mp4|m4v|ogg|ogv|webm|webmv|flv|wmv|mpeg|mov)/gi.test(a)?"video":"audio")+"/"+this.getTypeFromExtension(a)},getTypeFromExtension:function(a){switch(a){case "mp4":case "m4v":return"mp4";case "webm":case "webma":case "webmv":return"webm";case "ogg":case "oga":case "ogv":return"ogg";default:return a}},createErrorMessage:function(a,b,c){var d=a.htmlMediaElement,e=document.createElement("div");e.className=
"me-cannotplay";try{e.style.width=d.width+"px";e.style.height=d.height+"px"}catch(f){}e.innerHTML=b.customError?b.customError:c!==""?'<a href="'+a.url+'"><img src="'+c+'" width="100%" height="100%" /></a>':'<a href="'+a.url+'"><span>'+mejs.i18n.t("Download File")+"</span></a>";d.parentNode.insertBefore(e,d);d.style.display="none";b.error(d)},createPlugin:function(a,b,c,d,e,f){c=a.htmlMediaElement;var g=1,h=1,l="me_"+a.method+"_"+mejs.meIndex++,j=new mejs.PluginMediaElement(l,a.method,a.url),k=document.createElement("div"),
m;j.tagName=c.tagName;for(m=0;m<c.attributes.length;m++){var n=c.attributes[m];n.specified==true&&j.setAttribute(n.name,n.value)}for(m=c.parentNode;m!==null&&m.tagName.toLowerCase()!="body";){if(m.parentNode.tagName.toLowerCase()=="p"){m.parentNode.parentNode.insertBefore(m,m.parentNode);break}m=m.parentNode}if(a.isVideo){g=b.pluginWidth>0?b.pluginWidth:b.videoWidth>0?b.videoWidth:c.getAttribute("width")!==null?c.getAttribute("width"):b.defaultVideoWidth;h=b.pluginHeight>0?b.pluginHeight:b.videoHeight>
0?b.videoHeight:c.getAttribute("height")!==null?c.getAttribute("height"):b.defaultVideoHeight;g=mejs.Utility.encodeUrl(g);h=mejs.Utility.encodeUrl(h)}else if(b.enablePluginDebug){g=320;h=240}j.success=b.success;mejs.MediaPluginBridge.registerPluginElement(l,j,c);k.className="me-plugin";k.id=l+"_container";a.isVideo?c.parentNode.insertBefore(k,c):document.body.insertBefore(k,document.body.childNodes[0]);d=["id="+l,"isvideo="+(a.isVideo?"true":"false"),"autoplay="+(d?"true":"false"),"preload="+e,"width="+
g,"startvolume="+b.startVolume,"timerrate="+b.timerRate,"flashstreamer="+b.flashStreamer,"height="+h,"pseudostreamstart="+b.pseudoStreamingStartQueryParam];if(a.url!==null)a.method=="flash"?d.push("file="+mejs.Utility.encodeUrl(a.url)):d.push("file="+a.url);b.enablePluginDebug&&d.push("debug=true");b.enablePluginSmoothing&&d.push("smoothing=true");b.enablePseudoStreaming&&d.push("pseudostreaming=true");f&&d.push("controls=true");if(b.pluginVars)d=d.concat(b.pluginVars);switch(a.method){case "silverlight":k.innerHTML=
'<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="'+l+'" name="'+l+'" width="'+g+'" height="'+h+'" class="mejs-shim"><param name="initParams" value="'+d.join(",")+'" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="3.0.0.0" /><param name="autoUpgrade" value="true" /><param name="source" value="'+b.pluginPath+b.silverlightName+'" /></object>';break;case "flash":if(mejs.MediaFeatures.isIE){a=
document.createElement("div");k.appendChild(a);a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+l+'" width="'+g+'" height="'+h+'" class="mejs-shim"><param name="movie" value="'+b.pluginPath+b.flashName+"?x="+new Date+'" /><param name="flashvars" value="'+d.join("&amp;")+'" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'}else k.innerHTML=
'<embed id="'+l+'" name="'+l+'" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="always" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" src="'+b.pluginPath+b.flashName+'" flashvars="'+d.join("&")+'" width="'+g+'" height="'+h+'" class="mejs-shim"></embed>';break;case "youtube":b=a.url.substr(a.url.lastIndexOf("=")+1);youtubeSettings={container:k,containerId:k.id,pluginMediaElement:j,pluginId:l,
videoId:b,height:h,width:g};mejs.PluginDetector.hasPluginVersion("flash",[10,0,0])?mejs.YouTubeApi.createFlash(youtubeSettings):mejs.YouTubeApi.enqueueIframe(youtubeSettings);break;case "vimeo":j.vimeoid=a.url.substr(a.url.lastIndexOf("/")+1);k.innerHTML='<iframe src="http://player.vimeo.com/video/'+j.vimeoid+'?portrait=0&byline=0&title=0" width="'+g+'" height="'+h+'" frameborder="0" class="mejs-shim"></iframe>'}c.style.display="none";c.removeAttribute("autoplay");return j},updateNative:function(a,
b){var c=a.htmlMediaElement,d;for(d in mejs.HtmlMediaElement)c[d]=mejs.HtmlMediaElement[d];b.success(c,c);return c}};
mejs.YouTubeApi={isIframeStarted:false,isIframeLoaded:false,loadIframeApi:function(){if(!this.isIframeStarted){var a=document.createElement("script");a.src="//www.youtube.com/player_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b);this.isIframeStarted=true}},iframeQueue:[],enqueueIframe:function(a){if(this.isLoaded)this.createIframe(a);else{this.loadIframeApi();this.iframeQueue.push(a)}},createIframe:function(a){var b=a.pluginMediaElement,c=new YT.Player(a.containerId,
{height:a.height,width:a.width,videoId:a.videoId,playerVars:{controls:0},events:{onReady:function(){a.pluginMediaElement.pluginApi=c;mejs.MediaPluginBridge.initPlugin(a.pluginId);setInterval(function(){mejs.YouTubeApi.createEvent(c,b,"timeupdate")},250)},onStateChange:function(d){mejs.YouTubeApi.handleStateChange(d.data,c,b)}}})},createEvent:function(a,b,c){c={type:c,target:b};if(a&&a.getDuration){b.currentTime=c.currentTime=a.getCurrentTime();b.duration=c.duration=a.getDuration();c.paused=b.paused;
c.ended=b.ended;c.muted=a.isMuted();c.volume=a.getVolume()/100;c.bytesTotal=a.getVideoBytesTotal();c.bufferedBytes=a.getVideoBytesLoaded();var d=c.bufferedBytes/c.bytesTotal*c.duration;c.target.buffered=c.buffered={start:function(){return 0},end:function(){return d},length:1}}b.dispatchEvent(c.type,c)},iFrameReady:function(){for(this.isIframeLoaded=this.isLoaded=true;this.iframeQueue.length>0;)this.createIframe(this.iframeQueue.pop())},flashPlayers:{},createFlash:function(a){this.flashPlayers[a.pluginId]=
a;var b,c="//www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid="+a.pluginId+"&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0";if(mejs.MediaFeatures.isIE){b=document.createElement("div");a.container.appendChild(b);b.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+a.pluginId+'" width="'+a.width+'" height="'+a.height+'" class="mejs-shim"><param name="movie" value="'+
c+'" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'}else a.container.innerHTML='<object type="application/x-shockwave-flash" id="'+a.pluginId+'" data="'+c+'" width="'+a.width+'" height="'+a.height+'" style="visibility: visible; " class="mejs-shim"><param name="allowScriptAccess" value="always"><param name="wmode" value="transparent"></object>'},flashReady:function(a){var b=this.flashPlayers[a],c=
document.getElementById(a),d=b.pluginMediaElement;d.pluginApi=d.pluginElement=c;mejs.MediaPluginBridge.initPlugin(a);c.cueVideoById(b.videoId);a=b.containerId+"_callback";window[a]=function(e){mejs.YouTubeApi.handleStateChange(e,c,d)};c.addEventListener("onStateChange",a);setInterval(function(){mejs.YouTubeApi.createEvent(c,d,"timeupdate")},250)},handleStateChange:function(a,b,c){switch(a){case -1:c.paused=true;c.ended=true;mejs.YouTubeApi.createEvent(b,c,"loadedmetadata");break;case 0:c.paused=false;
c.ended=true;mejs.YouTubeApi.createEvent(b,c,"ended");break;case 1:c.paused=false;c.ended=false;mejs.YouTubeApi.createEvent(b,c,"play");mejs.YouTubeApi.createEvent(b,c,"playing");break;case 2:c.paused=true;c.ended=false;mejs.YouTubeApi.createEvent(b,c,"pause");break;case 3:mejs.YouTubeApi.createEvent(b,c,"progress")}}};function onYouTubePlayerAPIReady(){mejs.YouTubeApi.iFrameReady()}function onYouTubePlayerReady(a){mejs.YouTubeApi.flashReady(a)}window.mejs=mejs;window.MediaElement=mejs.MediaElement;
(function(a,b){var c={locale:{language:"",strings:{}},methods:{}};c.locale.getLanguage=function(){return c.locale.language||navigator.language};if(typeof mejsL10n!="undefined")c.locale.language=mejsL10n.language;c.locale.INIT_LANGUAGE=c.locale.getLanguage();c.methods.checkPlain=function(d){var e,f,g={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};d=String(d);for(e in g)if(g.hasOwnProperty(e)){f=RegExp(e,"g");d=d.replace(f,g[e])}return d};c.methods.formatString=function(d,e){for(var f in e){switch(f.charAt(0)){case "@":e[f]=
c.methods.checkPlain(e[f]);break;case "!":break;default:e[f]='<em class="placeholder">'+c.methods.checkPlain(e[f])+"</em>"}d=d.replace(f,e[f])}return d};c.methods.t=function(d,e,f){if(c.locale.strings&&c.locale.strings[f.context]&&c.locale.strings[f.context][d])d=c.locale.strings[f.context][d];if(e)d=c.methods.formatString(d,e);return d};c.t=function(d,e,f){if(typeof d==="string"&&d.length>0){var g=c.locale.getLanguage();f=f||{context:g};return c.methods.t(d,e,f)}else throw{name:"InvalidArgumentException",
message:"First argument is either not a string or empty."};};b.i18n=c})(document,mejs);(function(a){if(typeof mejsL10n!="undefined")a[mejsL10n.language]=mejsL10n.strings})(mejs.i18n.locale.strings);(function(a){a.de={Fullscreen:"Vollbild","Go Fullscreen":"Vollbild an","Turn off Fullscreen":"Vollbild aus",Close:"Schlie\u00dfen"}})(mejs.i18n.locale.strings);
(function(a){a.zh={Fullscreen:"\u5168\u87a2\u5e55","Go Fullscreen":"\u5168\u5c4f\u6a21\u5f0f","Turn off Fullscreen":"\u9000\u51fa\u5168\u5c4f\u6a21\u5f0f",Close:"\u95dc\u9589"}})(mejs.i18n.locale.strings);

/*!
 * MediaElementPlayer
 * http://mediaelementjs.com/
 *
 * Creates a controller bar for HTML5 <video> add <audio> tags
 * using jQuery and MediaElement.js (HTML5 Flash/Silverlight wrapper)
 *
 * Copyright 2010-2013, John Dyer (http://j.hn/)
 * License: MIT
 *
 */if(typeof jQuery!="undefined")mejs.$=jQuery;else if(typeof ender!="undefined")mejs.$=ender;
(function(f){mejs.MepDefaults={poster:"",showPosterWhenEnded:false,defaultVideoWidth:480,defaultVideoHeight:270,videoWidth:-1,videoHeight:-1,defaultAudioWidth:400,defaultAudioHeight:30,defaultSeekBackwardInterval:function(a){return a.duration*0.05},defaultSeekForwardInterval:function(a){return a.duration*0.05},audioWidth:-1,audioHeight:-1,startVolume:0.8,loop:false,autoRewind:true,enableAutosize:true,alwaysShowHours:false,showTimecodeFrameCount:false,framesPerSecond:25,autosizeProgress:true,alwaysShowControls:false,
hideVideoControlsOnLoad:false,clickToPlayPause:true,iPadUseNativeControls:false,iPhoneUseNativeControls:false,AndroidUseNativeControls:false,features:["playpause","current","progress","duration","tracks","volume","fullscreen"],isVideo:true,enableKeyboard:true,pauseOtherPlayers:true,keyActions:[{keys:[32,179],action:function(a,b){b.paused||b.ended?b.play():b.pause()}},{keys:[38],action:function(a,b){b.setVolume(Math.min(b.volume+0.1,1))}},{keys:[40],action:function(a,b){b.setVolume(Math.max(b.volume-
0.1,0))}},{keys:[37,227],action:function(a,b){if(!isNaN(b.duration)&&b.duration>0){if(a.isVideo){a.showControls();a.startControlsTimer()}var c=Math.max(b.currentTime-a.options.defaultSeekBackwardInterval(b),0);b.setCurrentTime(c)}}},{keys:[39,228],action:function(a,b){if(!isNaN(b.duration)&&b.duration>0){if(a.isVideo){a.showControls();a.startControlsTimer()}var c=Math.min(b.currentTime+a.options.defaultSeekForwardInterval(b),b.duration);b.setCurrentTime(c)}}},{keys:[70],action:function(a){if(typeof a.enterFullScreen!=
"undefined")a.isFullScreen?a.exitFullScreen():a.enterFullScreen()}}]};mejs.mepIndex=0;mejs.players={};mejs.MediaElementPlayer=function(a,b){if(!(this instanceof mejs.MediaElementPlayer))return new mejs.MediaElementPlayer(a,b);this.$media=this.$node=f(a);this.node=this.media=this.$media[0];if(typeof this.node.player!="undefined")return this.node.player;else this.node.player=this;if(typeof b=="undefined")b=this.$node.data("mejsoptions");this.options=f.extend({},mejs.MepDefaults,b);this.id="mep_"+mejs.mepIndex++;
mejs.players[this.id]=this;this.init();return this};mejs.MediaElementPlayer.prototype={hasFocus:false,controlsAreVisible:true,init:function(){var a=this,b=mejs.MediaFeatures,c=f.extend(true,{},a.options,{success:function(d,g){a.meReady(d,g)},error:function(d){a.handleError(d)}}),e=a.media.tagName.toLowerCase();a.isDynamic=e!=="audio"&&e!=="video";a.isVideo=a.isDynamic?a.options.isVideo:e!=="audio"&&a.options.isVideo;if(b.isiPad&&a.options.iPadUseNativeControls||b.isiPhone&&a.options.iPhoneUseNativeControls){a.$media.attr("controls",
"controls");if(b.isiPad&&a.media.getAttribute("autoplay")!==null){a.media.load();a.media.play()}}else if(!(b.isAndroid&&a.options.AndroidUseNativeControls)){a.$media.removeAttr("controls");a.container=f('<div id="'+a.id+'" class="mejs-container '+(mejs.MediaFeatures.svg?"svg":"no-svg")+'"><div class="mejs-inner"><div class="mejs-mediaelement"></div><div class="mejs-layers"></div><div class="mejs-controls"></div><div class="mejs-clear"></div></div></div>').addClass(a.$media[0].className).insertBefore(a.$media);
a.container.addClass((b.isAndroid?"mejs-android ":"")+(b.isiOS?"mejs-ios ":"")+(b.isiPad?"mejs-ipad ":"")+(b.isiPhone?"mejs-iphone ":"")+(a.isVideo?"mejs-video ":"mejs-audio "));if(b.isiOS){b=a.$media.clone();a.container.find(".mejs-mediaelement").append(b);a.$media.remove();a.$node=a.$media=b;a.node=a.media=b[0]}else a.container.find(".mejs-mediaelement").append(a.$media);a.controls=a.container.find(".mejs-controls");a.layers=a.container.find(".mejs-layers");b=a.isVideo?"video":"audio";e=b.substring(0,
1).toUpperCase()+b.substring(1);a.width=a.options[b+"Width"]>0||a.options[b+"Width"].toString().indexOf("%")>-1?a.options[b+"Width"]:a.media.style.width!==""&&a.media.style.width!==null?a.media.style.width:a.media.getAttribute("width")!==null?a.$media.attr("width"):a.options["default"+e+"Width"];a.height=a.options[b+"Height"]>0||a.options[b+"Height"].toString().indexOf("%")>-1?a.options[b+"Height"]:a.media.style.height!==""&&a.media.style.height!==null?a.media.style.height:a.$media[0].getAttribute("height")!==
null?a.$media.attr("height"):a.options["default"+e+"Height"];a.setPlayerSize(a.width,a.height);c.pluginWidth=a.width;c.pluginHeight=a.height}mejs.MediaElement(a.$media[0],c);typeof a.container!="undefined"&&a.controlsAreVisible&&a.container.trigger("controlsshown")},showControls:function(a){var b=this;a=typeof a=="undefined"||a;if(!b.controlsAreVisible){if(a){b.controls.css("visibility","visible").stop(true,true).fadeIn(200,function(){b.controlsAreVisible=true;b.container.trigger("controlsshown")});
b.container.find(".mejs-control").css("visibility","visible").stop(true,true).fadeIn(200,function(){b.controlsAreVisible=true})}else{b.controls.css("visibility","visible").css("display","block");b.container.find(".mejs-control").css("visibility","visible").css("display","block");b.controlsAreVisible=true;b.container.trigger("controlsshown")}b.setControlsSize()}},hideControls:function(a){var b=this;a=typeof a=="undefined"||a;if(!(!b.controlsAreVisible||b.options.alwaysShowControls))if(a){b.controls.stop(true,
true).fadeOut(200,function(){f(this).css("visibility","hidden").css("display","block");b.controlsAreVisible=false;b.container.trigger("controlshidden")});b.container.find(".mejs-control").stop(true,true).fadeOut(200,function(){f(this).css("visibility","hidden").css("display","block")})}else{b.controls.css("visibility","hidden").css("display","block");b.container.find(".mejs-control").css("visibility","hidden").css("display","block");b.controlsAreVisible=false;b.container.trigger("controlshidden")}},
controlsTimer:null,startControlsTimer:function(a){var b=this;a=typeof a!="undefined"?a:1500;b.killControlsTimer("start");b.controlsTimer=setTimeout(function(){b.hideControls();b.killControlsTimer("hide")},a)},killControlsTimer:function(){if(this.controlsTimer!==null){clearTimeout(this.controlsTimer);delete this.controlsTimer;this.controlsTimer=null}},controlsEnabled:true,disableControls:function(){this.killControlsTimer();this.hideControls(false);this.controlsEnabled=false},enableControls:function(){this.showControls(false);
this.controlsEnabled=true},meReady:function(a,b){var c=this,e=mejs.MediaFeatures,d=b.getAttribute("autoplay");d=!(typeof d=="undefined"||d===null||d==="false");var g;if(!c.created){c.created=true;c.media=a;c.domNode=b;if(!(e.isAndroid&&c.options.AndroidUseNativeControls)&&!(e.isiPad&&c.options.iPadUseNativeControls)&&!(e.isiPhone&&c.options.iPhoneUseNativeControls)){c.buildposter(c,c.controls,c.layers,c.media);c.buildkeyboard(c,c.controls,c.layers,c.media);c.buildoverlays(c,c.controls,c.layers,c.media);
c.findTracks();for(g in c.options.features){e=c.options.features[g];if(c["build"+e])try{c["build"+e](c,c.controls,c.layers,c.media)}catch(k){}}c.container.trigger("controlsready");c.setPlayerSize(c.width,c.height);c.setControlsSize();if(c.isVideo){if(mejs.MediaFeatures.hasTouch)c.$media.bind("touchstart",function(){if(c.controlsAreVisible)c.hideControls(false);else c.controlsEnabled&&c.showControls(false)});else{mejs.MediaElementPlayer.prototype.clickToPlayPauseCallback=function(){if(c.options.clickToPlayPause)c.media.paused?
c.media.play():c.media.pause()};c.media.addEventListener("click",c.clickToPlayPauseCallback,false);c.container.bind("mouseenter mouseover",function(){if(c.controlsEnabled)if(!c.options.alwaysShowControls){c.killControlsTimer("enter");c.showControls();c.startControlsTimer(2500)}}).bind("mousemove",function(){if(c.controlsEnabled){c.controlsAreVisible||c.showControls();c.options.alwaysShowControls||c.startControlsTimer(2500)}}).bind("mouseleave",function(){c.controlsEnabled&&!c.media.paused&&!c.options.alwaysShowControls&&
c.startControlsTimer(1E3)})}c.options.hideVideoControlsOnLoad&&c.hideControls(false);d&&!c.options.alwaysShowControls&&c.hideControls();c.options.enableAutosize&&c.media.addEventListener("loadedmetadata",function(j){if(c.options.videoHeight<=0&&c.domNode.getAttribute("height")===null&&!isNaN(j.target.videoHeight)){c.setPlayerSize(j.target.videoWidth,j.target.videoHeight);c.setControlsSize();c.media.setVideoSize(j.target.videoWidth,j.target.videoHeight)}},false)}a.addEventListener("play",function(){for(var j in mejs.players){var m=
mejs.players[j];m.id!=c.id&&c.options.pauseOtherPlayers&&!m.paused&&!m.ended&&m.pause();m.hasFocus=false}c.hasFocus=true},false);c.media.addEventListener("ended",function(){if(c.options.autoRewind)try{c.media.setCurrentTime(0)}catch(j){}c.media.pause();c.setProgressRail&&c.setProgressRail();c.setCurrentRail&&c.setCurrentRail();if(c.options.loop)c.media.play();else!c.options.alwaysShowControls&&c.controlsEnabled&&c.showControls()},false);c.media.addEventListener("loadedmetadata",function(){c.updateDuration&&
c.updateDuration();c.updateCurrent&&c.updateCurrent();if(!c.isFullScreen){c.setPlayerSize(c.width,c.height);c.setControlsSize()}},false);setTimeout(function(){c.setPlayerSize(c.width,c.height);c.setControlsSize()},50);c.globalBind("resize",function(){c.isFullScreen||mejs.MediaFeatures.hasTrueNativeFullScreen&&document.webkitIsFullScreen||c.setPlayerSize(c.width,c.height);c.setControlsSize()});c.media.pluginType=="youtube"&&c.container.find(".mejs-overlay-play").hide()}if(d&&a.pluginType=="native"){a.load();
a.play()}if(c.options.success)typeof c.options.success=="string"?window[c.options.success](c.media,c.domNode,c):c.options.success(c.media,c.domNode,c)}},handleError:function(a){this.controls.hide();this.options.error&&this.options.error(a)},setPlayerSize:function(a,b){if(typeof a!="undefined")this.width=a;if(typeof b!="undefined")this.height=b;if(this.height.toString().indexOf("%")>0||this.$node.css("max-width")==="100%"||parseInt(this.$node.css("max-width").replace(/px/,""),10)/this.$node.offsetParent().width()===
1||this.$node[0].currentStyle&&this.$node[0].currentStyle.maxWidth==="100%"){var c=this.isVideo?this.media.videoWidth&&this.media.videoWidth>0?this.media.videoWidth:this.options.defaultVideoWidth:this.options.defaultAudioWidth,e=this.isVideo?this.media.videoHeight&&this.media.videoHeight>0?this.media.videoHeight:this.options.defaultVideoHeight:this.options.defaultAudioHeight,d=this.container.parent().closest(":visible").width();c=this.isVideo||!this.options.autosizeProgress?parseInt(d*e/c,10):e;if(this.container.parent()[0].tagName.toLowerCase()===
"body"){d=f(window).width();c=f(window).height()}if(c!=0&&d!=0){this.container.width(d).height(c);this.$media.add(this.container.find(".mejs-shim")).width("100%").height("100%");this.isVideo&&this.media.setVideoSize&&this.media.setVideoSize(d,c);this.layers.children(".mejs-layer").width("100%").height("100%")}}else{this.container.width(this.width).height(this.height);this.layers.children(".mejs-layer").width(this.width).height(this.height)}d=this.layers.find(".mejs-overlay-play");c=d.find(".mejs-overlay-button");
d.height(this.container.height()-this.controls.height());c.css("margin-top","-"+(c.height()/2-this.controls.height()/2).toString()+"px")},setControlsSize:function(){var a=0,b=0,c=this.controls.find(".mejs-time-rail"),e=this.controls.find(".mejs-time-total");this.controls.find(".mejs-time-current");this.controls.find(".mejs-time-loaded");var d=c.siblings();if(this.options&&!this.options.autosizeProgress)b=parseInt(c.css("width"));if(b===0||!b){d.each(function(){var g=f(this);if(g.css("position")!=
"absolute"&&g.is(":visible"))a+=f(this).outerWidth(true)});b=this.controls.width()-a-(c.outerWidth(true)-c.width())}c.width(b);e.width(b-(e.outerWidth(true)-e.width()));this.setProgressRail&&this.setProgressRail();this.setCurrentRail&&this.setCurrentRail()},buildposter:function(a,b,c,e){var d=f('<div class="mejs-poster mejs-layer"></div>').appendTo(c);b=a.$media.attr("poster");if(a.options.poster!=="")b=a.options.poster;b!==""&&b!=null?this.setPoster(b):d.hide();e.addEventListener("play",function(){d.hide()},
false);a.options.showPosterWhenEnded&&a.options.autoRewind&&e.addEventListener("ended",function(){d.show()},false)},setPoster:function(a){var b=this.container.find(".mejs-poster"),c=b.find("img");if(c.length==0)c=f('<img width="100%" height="100%" />').appendTo(b);c.attr("src",a);b.css({"background-image":"url("+a+")"})},buildoverlays:function(a,b,c,e){var d=this;if(a.isVideo){var g=f('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-loading"><span></span></div></div>').hide().appendTo(c),
k=f('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-error"></div></div>').hide().appendTo(c),j=f('<div class="mejs-overlay mejs-layer mejs-overlay-play"><div class="mejs-overlay-button"></div></div>').appendTo(c).click(function(){if(d.options.clickToPlayPause)e.paused?e.play():e.pause()});e.addEventListener("play",function(){j.hide();g.hide();b.find(".mejs-time-buffering").hide();k.hide()},false);e.addEventListener("playing",function(){j.hide();g.hide();b.find(".mejs-time-buffering").hide();
k.hide()},false);e.addEventListener("seeking",function(){g.show();b.find(".mejs-time-buffering").show()},false);e.addEventListener("seeked",function(){g.hide();b.find(".mejs-time-buffering").hide()},false);e.addEventListener("pause",function(){mejs.MediaFeatures.isiPhone||j.show()},false);e.addEventListener("waiting",function(){g.show();b.find(".mejs-time-buffering").show()},false);e.addEventListener("loadeddata",function(){g.show();b.find(".mejs-time-buffering").show()},false);e.addEventListener("canplay",
function(){g.hide();b.find(".mejs-time-buffering").hide()},false);e.addEventListener("error",function(){g.hide();b.find(".mejs-time-buffering").hide();k.show();k.find("mejs-overlay-error").html("Error loading this resource")},false)}},buildkeyboard:function(a,b,c,e){this.globalBind("keydown",function(d){if(a.hasFocus&&a.options.enableKeyboard)for(var g=0,k=a.options.keyActions.length;g<k;g++)for(var j=a.options.keyActions[g],m=0,q=j.keys.length;m<q;m++)if(d.keyCode==j.keys[m]){d.preventDefault();
j.action(a,e,d.keyCode);return false}return true});this.globalBind("click",function(d){if(f(d.target).closest(".mejs-container").length==0)a.hasFocus=false})},findTracks:function(){var a=this,b=a.$media.find("track");a.tracks=[];b.each(function(c,e){e=f(e);a.tracks.push({srclang:e.attr("srclang")?e.attr("srclang").toLowerCase():"",src:e.attr("src"),kind:e.attr("kind"),label:e.attr("label")||"",entries:[],isLoaded:false})})},changeSkin:function(a){this.container[0].className="mejs-container "+a;this.setPlayerSize(this.width,
this.height);this.setControlsSize()},play:function(){this.media.play()},pause:function(){try{this.media.pause()}catch(a){}},load:function(){this.media.load()},setMuted:function(a){this.media.setMuted(a)},setCurrentTime:function(a){this.media.setCurrentTime(a)},getCurrentTime:function(){return this.media.currentTime},setVolume:function(a){this.media.setVolume(a)},getVolume:function(){return this.media.volume},setSrc:function(a){this.media.setSrc(a)},remove:function(){var a,b;for(a in this.options.features){b=
this.options.features[a];if(this["clean"+b])try{this["clean"+b](this)}catch(c){}}if(this.isDynamic)this.$node.insertBefore(this.container);else{this.$media.prop("controls",true);this.$node.clone().show().insertBefore(this.container);this.$node.remove()}this.media.pluginType!=="native"&&this.media.remove();delete mejs.players[this.id];this.container.remove();this.globalUnbind();delete this.node.player}};(function(){function a(c,e){var d={d:[],w:[]};f.each((c||"").split(" "),function(g,k){var j=k+"."+
e;if(j.indexOf(".")===0){d.d.push(j);d.w.push(j)}else d[b.test(k)?"w":"d"].push(j)});d.d=d.d.join(" ");d.w=d.w.join(" ");return d}var b=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;mejs.MediaElementPlayer.prototype.globalBind=function(c,e,d){c=a(c,this.id);c.d&&f(document).bind(c.d,e,d);c.w&&f(window).bind(c.w,e,d)};mejs.MediaElementPlayer.prototype.globalUnbind=function(c,e){c=a(c,this.id);c.d&&f(document).unbind(c.d,e);c.w&&f(window).unbind(c.w,
e)}})();if(typeof jQuery!="undefined")jQuery.fn.mediaelementplayer=function(a){a===false?this.each(function(){var b=jQuery(this).data("mediaelementplayer");b&&b.remove();jQuery(this).removeData("mediaelementplayer")}):this.each(function(){jQuery(this).data("mediaelementplayer",new mejs.MediaElementPlayer(this,a))});return this};f(document).ready(function(){f(".mejs-player").mediaelementplayer()});window.MediaElementPlayer=mejs.MediaElementPlayer})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{playpauseText:mejs.i18n.t("Play/Pause")});f.extend(MediaElementPlayer.prototype,{buildplaypause:function(a,b,c,e){var d=f('<div class="mejs-button mejs-playpause-button mejs-play" ><button type="button" aria-controls="'+this.id+'" title="'+this.options.playpauseText+'" aria-label="'+this.options.playpauseText+'"></button></div>').appendTo(b).click(function(g){g.preventDefault();e.paused?e.play():e.pause();return false});e.addEventListener("play",function(){d.removeClass("mejs-play").addClass("mejs-pause")},
false);e.addEventListener("playing",function(){d.removeClass("mejs-play").addClass("mejs-pause")},false);e.addEventListener("pause",function(){d.removeClass("mejs-pause").addClass("mejs-play")},false);e.addEventListener("paused",function(){d.removeClass("mejs-pause").addClass("mejs-play")},false)}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{stopText:"Stop"});f.extend(MediaElementPlayer.prototype,{buildstop:function(a,b,c,e){f('<div class="mejs-button mejs-stop-button mejs-stop"><button type="button" aria-controls="'+this.id+'" title="'+this.options.stopText+'" aria-label="'+this.options.stopText+'"></button></div>').appendTo(b).click(function(){e.paused||e.pause();if(e.currentTime>0){e.setCurrentTime(0);e.pause();b.find(".mejs-time-current").width("0px");b.find(".mejs-time-handle").css("left",
"0px");b.find(".mejs-time-float-current").html(mejs.Utility.secondsToTimeCode(0));b.find(".mejs-currenttime").html(mejs.Utility.secondsToTimeCode(0));c.find(".mejs-poster").show()}})}})})(mejs.$);
(function(f){f.extend(MediaElementPlayer.prototype,{buildprogress:function(a,b,c,e){f('<div class="mejs-time-rail"><span class="mejs-time-total"><span class="mejs-time-buffering"></span><span class="mejs-time-loaded"></span><span class="mejs-time-current"></span><span class="mejs-time-handle"></span><span class="mejs-time-float"><span class="mejs-time-float-current">00:00</span><span class="mejs-time-float-corner"></span></span></span></div>').appendTo(b);b.find(".mejs-time-buffering").hide();var d=
this,g=b.find(".mejs-time-total");c=b.find(".mejs-time-loaded");var k=b.find(".mejs-time-current"),j=b.find(".mejs-time-handle"),m=b.find(".mejs-time-float"),q=b.find(".mejs-time-float-current"),p=function(h){h=h.pageX;var l=g.offset(),r=g.outerWidth(true),n=0,o=n=0;if(e.duration){if(h<l.left)h=l.left;else if(h>r+l.left)h=r+l.left;o=h-l.left;n=o/r;n=n<=0.02?0:n*e.duration;t&&n!==e.currentTime&&e.setCurrentTime(n);if(!mejs.MediaFeatures.hasTouch){m.css("left",o);q.html(mejs.Utility.secondsToTimeCode(n));
m.show()}}},t=false;g.bind("mousedown",function(h){if(h.which===1){t=true;p(h);d.globalBind("mousemove.dur",function(l){p(l)});d.globalBind("mouseup.dur",function(){t=false;m.hide();d.globalUnbind(".dur")});return false}}).bind("mouseenter",function(){d.globalBind("mousemove.dur",function(h){p(h)});mejs.MediaFeatures.hasTouch||m.show()}).bind("mouseleave",function(){if(!t){d.globalUnbind(".dur");m.hide()}});e.addEventListener("progress",function(h){a.setProgressRail(h);a.setCurrentRail(h)},false);
e.addEventListener("timeupdate",function(h){a.setProgressRail(h);a.setCurrentRail(h)},false);d.loaded=c;d.total=g;d.current=k;d.handle=j},setProgressRail:function(a){var b=a!=undefined?a.target:this.media,c=null;if(b&&b.buffered&&b.buffered.length>0&&b.buffered.end&&b.duration)c=b.buffered.end(0)/b.duration;else if(b&&b.bytesTotal!=undefined&&b.bytesTotal>0&&b.bufferedBytes!=undefined)c=b.bufferedBytes/b.bytesTotal;else if(a&&a.lengthComputable&&a.total!=0)c=a.loaded/a.total;if(c!==null){c=Math.min(1,
Math.max(0,c));this.loaded&&this.total&&this.loaded.width(this.total.width()*c)}},setCurrentRail:function(){if(this.media.currentTime!=undefined&&this.media.duration)if(this.total&&this.handle){var a=Math.round(this.total.width()*this.media.currentTime/this.media.duration),b=a-Math.round(this.handle.outerWidth(true)/2);this.current.width(a);this.handle.css("left",b)}}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{duration:-1,timeAndDurationSeparator:"<span> | </span>"});f.extend(MediaElementPlayer.prototype,{buildcurrent:function(a,b,c,e){f('<div class="mejs-time"><span class="mejs-currenttime">'+(a.options.alwaysShowHours?"00:":"")+(a.options.showTimecodeFrameCount?"00:00:00":"00:00")+"</span></div>").appendTo(b);this.currenttime=this.controls.find(".mejs-currenttime");e.addEventListener("timeupdate",function(){a.updateCurrent()},false)},buildduration:function(a,b,
c,e){if(b.children().last().find(".mejs-currenttime").length>0)f(this.options.timeAndDurationSeparator+'<span class="mejs-duration">'+(this.options.duration>0?mejs.Utility.secondsToTimeCode(this.options.duration,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25):(a.options.alwaysShowHours?"00:":"")+(a.options.showTimecodeFrameCount?"00:00:00":"00:00"))+"</span>").appendTo(b.find(".mejs-time"));else{b.find(".mejs-currenttime").parent().addClass("mejs-currenttime-container");
f('<div class="mejs-time mejs-duration-container"><span class="mejs-duration">'+(this.options.duration>0?mejs.Utility.secondsToTimeCode(this.options.duration,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25):(a.options.alwaysShowHours?"00:":"")+(a.options.showTimecodeFrameCount?"00:00:00":"00:00"))+"</span></div>").appendTo(b)}this.durationD=this.controls.find(".mejs-duration");e.addEventListener("timeupdate",function(){a.updateDuration()},
false)},updateCurrent:function(){if(this.currenttime)this.currenttime.html(mejs.Utility.secondsToTimeCode(this.media.currentTime,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25))},updateDuration:function(){this.container.toggleClass("mejs-long-video",this.media.duration>3600);if(this.durationD&&(this.options.duration>0||this.media.duration))this.durationD.html(mejs.Utility.secondsToTimeCode(this.options.duration>0?this.options.duration:
this.media.duration,this.options.alwaysShowHours,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25))}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{muteText:mejs.i18n.t("Mute Toggle"),hideVolumeOnTouchDevices:true,audioVolume:"horizontal",videoVolume:"vertical"});f.extend(MediaElementPlayer.prototype,{buildvolume:function(a,b,c,e){if(!(mejs.MediaFeatures.hasTouch&&this.options.hideVolumeOnTouchDevices)){var d=this,g=d.isVideo?d.options.videoVolume:d.options.audioVolume,k=g=="horizontal"?f('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="'+d.id+'" title="'+d.options.muteText+
'" aria-label="'+d.options.muteText+'"></button></div><div class="mejs-horizontal-volume-slider"><div class="mejs-horizontal-volume-total"></div><div class="mejs-horizontal-volume-current"></div><div class="mejs-horizontal-volume-handle"></div></div>').appendTo(b):f('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="'+d.id+'" title="'+d.options.muteText+'" aria-label="'+d.options.muteText+'"></button><div class="mejs-volume-slider"><div class="mejs-volume-total"></div><div class="mejs-volume-current"></div><div class="mejs-volume-handle"></div></div></div>').appendTo(b),
j=d.container.find(".mejs-volume-slider, .mejs-horizontal-volume-slider"),m=d.container.find(".mejs-volume-total, .mejs-horizontal-volume-total"),q=d.container.find(".mejs-volume-current, .mejs-horizontal-volume-current"),p=d.container.find(".mejs-volume-handle, .mejs-horizontal-volume-handle"),t=function(n,o){if(!j.is(":visible")&&typeof o=="undefined"){j.show();t(n,true);j.hide()}else{n=Math.max(0,n);n=Math.min(n,1);n==0?k.removeClass("mejs-mute").addClass("mejs-unmute"):k.removeClass("mejs-unmute").addClass("mejs-mute");
if(g=="vertical"){var s=m.height(),u=m.position(),v=s-s*n;p.css("top",Math.round(u.top+v-p.height()/2));q.height(s-v);q.css("top",u.top+v)}else{s=m.width();u=m.position();s=s*n;p.css("left",Math.round(u.left+s-p.width()/2));q.width(Math.round(s))}}},h=function(n){var o=null,s=m.offset();if(g=="vertical"){o=m.height();parseInt(m.css("top").replace(/px/,""),10);o=(o-(n.pageY-s.top))/o;if(s.top==0||s.left==0)return}else{o=m.width();o=(n.pageX-s.left)/o}o=Math.max(0,o);o=Math.min(o,1);t(o);o==0?e.setMuted(true):
e.setMuted(false);e.setVolume(o)},l=false,r=false;k.hover(function(){j.show();r=true},function(){r=false;!l&&g=="vertical"&&j.hide()});j.bind("mouseover",function(){r=true}).bind("mousedown",function(n){h(n);d.globalBind("mousemove.vol",function(o){h(o)});d.globalBind("mouseup.vol",function(){l=false;d.globalUnbind(".vol");!r&&g=="vertical"&&j.hide()});l=true;return false});k.find("button").click(function(){e.setMuted(!e.muted)});e.addEventListener("volumechange",function(){if(!l)if(e.muted){t(0);
k.removeClass("mejs-mute").addClass("mejs-unmute")}else{t(e.volume);k.removeClass("mejs-unmute").addClass("mejs-mute")}},false);if(d.container.is(":visible")){t(a.options.startVolume);a.options.startVolume===0&&e.setMuted(true);e.pluginType==="native"&&e.setVolume(a.options.startVolume)}}}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{usePluginFullScreen:true,newWindowCallback:function(){return""},fullscreenText:mejs.i18n.t("Fullscreen")});f.extend(MediaElementPlayer.prototype,{isFullScreen:false,isNativeFullScreen:false,isInIframe:false,buildfullscreen:function(a,b,c,e){if(a.isVideo){a.isInIframe=window.location!=window.parent.location;if(mejs.MediaFeatures.hasTrueNativeFullScreen){c=function(){if(a.isFullScreen)if(mejs.MediaFeatures.isFullScreen()){a.isNativeFullScreen=true;a.setControlsSize()}else{a.isNativeFullScreen=
false;a.exitFullScreen()}};mejs.MediaFeatures.hasMozNativeFullScreen?a.globalBind(mejs.MediaFeatures.fullScreenEventName,c):a.container.bind(mejs.MediaFeatures.fullScreenEventName,c)}var d=this,g=f('<div class="mejs-button mejs-fullscreen-button"><button type="button" aria-controls="'+d.id+'" title="'+d.options.fullscreenText+'" aria-label="'+d.options.fullscreenText+'"></button></div>').appendTo(b);if(d.media.pluginType==="native"||!d.options.usePluginFullScreen&&!mejs.MediaFeatures.isFirefox)g.click(function(){mejs.MediaFeatures.hasTrueNativeFullScreen&&
mejs.MediaFeatures.isFullScreen()||a.isFullScreen?a.exitFullScreen():a.enterFullScreen()});else{var k=null;if(function(){var h=document.createElement("x"),l=document.documentElement,r=window.getComputedStyle;if(!("pointerEvents"in h.style))return false;h.style.pointerEvents="auto";h.style.pointerEvents="x";l.appendChild(h);r=r&&r(h,"").pointerEvents==="auto";l.removeChild(h);return!!r}()&&!mejs.MediaFeatures.isOpera){var j=false,m=function(){if(j){for(var h in q)q[h].hide();g.css("pointer-events",
"");d.controls.css("pointer-events","");d.media.removeEventListener("click",d.clickToPlayPauseCallback);j=false}},q={};b=["top","left","right","bottom"];var p,t=function(){var h=g.offset().left-d.container.offset().left,l=g.offset().top-d.container.offset().top,r=g.outerWidth(true),n=g.outerHeight(true),o=d.container.width(),s=d.container.height();for(p in q)q[p].css({position:"absolute",top:0,left:0});q.top.width(o).height(l);q.left.width(h).height(n).css({top:l});q.right.width(o-h-r).height(n).css({top:l,
left:h+r});q.bottom.width(o).height(s-n-l).css({top:l+n})};d.globalBind("resize",function(){t()});p=0;for(c=b.length;p<c;p++)q[b[p]]=f('<div class="mejs-fullscreen-hover" />').appendTo(d.container).mouseover(m).hide();g.on("mouseover",function(){if(!d.isFullScreen){var h=g.offset(),l=a.container.offset();e.positionFullscreenButton(h.left-l.left,h.top-l.top,false);g.css("pointer-events","none");d.controls.css("pointer-events","none");d.media.addEventListener("click",d.clickToPlayPauseCallback);for(p in q)q[p].show();
t();j=true}});e.addEventListener("fullscreenchange",function(){d.isFullScreen=!d.isFullScreen;d.isFullScreen?d.media.removeEventListener("click",d.clickToPlayPauseCallback):d.media.addEventListener("click",d.clickToPlayPauseCallback);m()});d.globalBind("mousemove",function(h){if(j){var l=g.offset();if(h.pageY<l.top||h.pageY>l.top+g.outerHeight(true)||h.pageX<l.left||h.pageX>l.left+g.outerWidth(true)){g.css("pointer-events","");d.controls.css("pointer-events","");j=false}}})}else g.on("mouseover",
function(){if(k!==null){clearTimeout(k);delete k}var h=g.offset(),l=a.container.offset();e.positionFullscreenButton(h.left-l.left,h.top-l.top,true)}).on("mouseout",function(){if(k!==null){clearTimeout(k);delete k}k=setTimeout(function(){e.hideFullscreenButton()},1500)})}a.fullscreenBtn=g;d.globalBind("keydown",function(h){if((mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen()||d.isFullScreen)&&h.keyCode==27)a.exitFullScreen()})}},cleanfullscreen:function(a){a.exitFullScreen()},
containerSizeTimeout:null,enterFullScreen:function(){var a=this;if(!(a.media.pluginType!=="native"&&(mejs.MediaFeatures.isFirefox||a.options.usePluginFullScreen))){f(document.documentElement).addClass("mejs-fullscreen");normalHeight=a.container.height();normalWidth=a.container.width();if(a.media.pluginType==="native")if(mejs.MediaFeatures.hasTrueNativeFullScreen){mejs.MediaFeatures.requestFullScreen(a.container[0]);a.isInIframe&&setTimeout(function c(){if(a.isNativeFullScreen)f(window).width()!==
screen.width?a.exitFullScreen():setTimeout(c,500)},500)}else if(mejs.MediaFeatures.hasSemiNativeFullScreen){a.media.webkitEnterFullscreen();return}if(a.isInIframe){var b=a.options.newWindowCallback(this);if(b!=="")if(mejs.MediaFeatures.hasTrueNativeFullScreen)setTimeout(function(){if(!a.isNativeFullScreen){a.pause();window.open(b,a.id,"top=0,left=0,width="+screen.availWidth+",height="+screen.availHeight+",resizable=yes,scrollbars=no,status=no,toolbar=no")}},250);else{a.pause();window.open(b,a.id,
"top=0,left=0,width="+screen.availWidth+",height="+screen.availHeight+",resizable=yes,scrollbars=no,status=no,toolbar=no");return}}a.container.addClass("mejs-container-fullscreen").width("100%").height("100%");a.containerSizeTimeout=setTimeout(function(){a.container.css({width:"100%",height:"100%"});a.setControlsSize()},500);if(a.media.pluginType==="native")a.$media.width("100%").height("100%");else{a.container.find(".mejs-shim").width("100%").height("100%");a.media.setVideoSize(f(window).width(),
f(window).height())}a.layers.children("div").width("100%").height("100%");a.fullscreenBtn&&a.fullscreenBtn.removeClass("mejs-fullscreen").addClass("mejs-unfullscreen");a.setControlsSize();a.isFullScreen=true}},exitFullScreen:function(){clearTimeout(this.containerSizeTimeout);if(this.media.pluginType!=="native"&&mejs.MediaFeatures.isFirefox)this.media.setFullscreen(false);else{if(mejs.MediaFeatures.hasTrueNativeFullScreen&&(mejs.MediaFeatures.isFullScreen()||this.isFullScreen))mejs.MediaFeatures.cancelFullScreen();
f(document.documentElement).removeClass("mejs-fullscreen");this.container.removeClass("mejs-container-fullscreen").width(normalWidth).height(normalHeight);if(this.media.pluginType==="native")this.$media.width(normalWidth).height(normalHeight);else{this.container.find(".mejs-shim").width(normalWidth).height(normalHeight);this.media.setVideoSize(normalWidth,normalHeight)}this.layers.children("div").width(normalWidth).height(normalHeight);this.fullscreenBtn.removeClass("mejs-unfullscreen").addClass("mejs-fullscreen");
this.setControlsSize();this.isFullScreen=false}}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{startLanguage:"",tracksText:mejs.i18n.t("Captions/Subtitles"),hideCaptionsButtonWhenEmpty:true,toggleCaptionsButtonWhenOnlyOne:false,slidesSelector:""});f.extend(MediaElementPlayer.prototype,{hasChapters:false,buildtracks:function(a,b,c,e){if(a.tracks.length!=0){var d;if(this.domNode.textTracks)for(d=this.domNode.textTracks.length-1;d>=0;d--)this.domNode.textTracks[d].mode="hidden";a.chapters=f('<div class="mejs-chapters mejs-layer"></div>').prependTo(c).hide();a.captions=
f('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position mejs-captions-position-hover"><span class="mejs-captions-text"></span></div></div>').prependTo(c).hide();a.captionsText=a.captions.find(".mejs-captions-text");a.captionsButton=f('<div class="mejs-button mejs-captions-button"><button type="button" aria-controls="'+this.id+'" title="'+this.options.tracksText+'" aria-label="'+this.options.tracksText+'"></button><div class="mejs-captions-selector"><ul><li><input type="radio" name="'+
a.id+'_captions" id="'+a.id+'_captions_none" value="none" checked="checked" /><label for="'+a.id+'_captions_none">'+mejs.i18n.t("None")+"</label></li></ul></div></div>").appendTo(b);for(d=b=0;d<a.tracks.length;d++)a.tracks[d].kind=="subtitles"&&b++;this.options.toggleCaptionsButtonWhenOnlyOne&&b==1?a.captionsButton.on("click",function(){a.setTrack(a.selectedTrack==null?a.tracks[0].srclang:"none")}):a.captionsButton.hover(function(){f(this).find(".mejs-captions-selector").css("visibility","visible")},
function(){f(this).find(".mejs-captions-selector").css("visibility","hidden")}).on("click","input[type=radio]",function(){lang=this.value;a.setTrack(lang)});a.options.alwaysShowControls?a.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover"):a.container.bind("controlsshown",function(){a.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover")}).bind("controlshidden",function(){e.paused||a.container.find(".mejs-captions-position").removeClass("mejs-captions-position-hover")});
a.trackToLoad=-1;a.selectedTrack=null;a.isLoadingTrack=false;for(d=0;d<a.tracks.length;d++)a.tracks[d].kind=="subtitles"&&a.addTrackButton(a.tracks[d].srclang,a.tracks[d].label);a.loadNextTrack();e.addEventListener("timeupdate",function(){a.displayCaptions()},false);if(a.options.slidesSelector!=""){a.slidesContainer=f(a.options.slidesSelector);e.addEventListener("timeupdate",function(){a.displaySlides()},false)}e.addEventListener("loadedmetadata",function(){a.displayChapters()},false);a.container.hover(function(){if(a.hasChapters){a.chapters.css("visibility",
"visible");a.chapters.fadeIn(200).height(a.chapters.find(".mejs-chapter").outerHeight())}},function(){a.hasChapters&&!e.paused&&a.chapters.fadeOut(200,function(){f(this).css("visibility","hidden");f(this).css("display","block")})});a.node.getAttribute("autoplay")!==null&&a.chapters.css("visibility","hidden")}},setTrack:function(a){var b;if(a=="none"){this.selectedTrack=null;this.captionsButton.removeClass("mejs-captions-enabled")}else for(b=0;b<this.tracks.length;b++)if(this.tracks[b].srclang==a){this.selectedTrack==
null&&this.captionsButton.addClass("mejs-captions-enabled");this.selectedTrack=this.tracks[b];this.captions.attr("lang",this.selectedTrack.srclang);this.displayCaptions();break}},loadNextTrack:function(){this.trackToLoad++;if(this.trackToLoad<this.tracks.length){this.isLoadingTrack=true;this.loadTrack(this.trackToLoad)}else{this.isLoadingTrack=false;this.checkForTracks()}},loadTrack:function(a){var b=this,c=b.tracks[a];f.ajax({url:c.src,dataType:"text",success:function(e){c.entries=typeof e=="string"&&
/<tt\s+xml/ig.exec(e)?mejs.TrackFormatParser.dfxp.parse(e):mejs.TrackFormatParser.webvvt.parse(e);c.isLoaded=true;b.enableTrackButton(c.srclang,c.label);b.loadNextTrack();c.kind=="chapters"&&b.media.addEventListener("play",function(){b.media.duration>0&&b.displayChapters(c)},false);c.kind=="slides"&&b.setupSlides(c)},error:function(){b.loadNextTrack()}})},enableTrackButton:function(a,b){if(b==="")b=mejs.language.codes[a]||a;this.captionsButton.find("input[value="+a+"]").prop("disabled",false).siblings("label").html(b);
this.options.startLanguage==a&&f("#"+this.id+"_captions_"+a).click();this.adjustLanguageBox()},addTrackButton:function(a,b){if(b==="")b=mejs.language.codes[a]||a;this.captionsButton.find("ul").append(f('<li><input type="radio" name="'+this.id+'_captions" id="'+this.id+"_captions_"+a+'" value="'+a+'" disabled="disabled" /><label for="'+this.id+"_captions_"+a+'">'+b+" (loading)</label></li>"));this.adjustLanguageBox();this.container.find(".mejs-captions-translations option[value="+a+"]").remove()},
adjustLanguageBox:function(){this.captionsButton.find(".mejs-captions-selector").height(this.captionsButton.find(".mejs-captions-selector ul").outerHeight(true)+this.captionsButton.find(".mejs-captions-translations").outerHeight(true))},checkForTracks:function(){var a=false;if(this.options.hideCaptionsButtonWhenEmpty){for(i=0;i<this.tracks.length;i++)if(this.tracks[i].kind=="subtitles"){a=true;break}if(!a){this.captionsButton.hide();this.setControlsSize()}}},displayCaptions:function(){if(typeof this.tracks!=
"undefined"){var a,b=this.selectedTrack;if(b!=null&&b.isLoaded)for(a=0;a<b.entries.times.length;a++)if(this.media.currentTime>=b.entries.times[a].start&&this.media.currentTime<=b.entries.times[a].stop){this.captionsText.html(b.entries.text[a]);this.captions.show().height(0);return}this.captions.hide()}},setupSlides:function(a){this.slides=a;this.slides.entries.imgs=[this.slides.entries.text.length];this.showSlide(0)},showSlide:function(a){if(!(typeof this.tracks=="undefined"||typeof this.slidesContainer==
"undefined")){var b=this,c=b.slides.entries.text[a],e=b.slides.entries.imgs[a];if(typeof e=="undefined"||typeof e.fadeIn=="undefined")b.slides.entries.imgs[a]=e=f('<img src="'+c+'">').on("load",function(){e.appendTo(b.slidesContainer).hide().fadeIn().siblings(":visible").fadeOut()});else!e.is(":visible")&&!e.is(":animated")&&e.fadeIn().siblings(":visible").fadeOut()}},displaySlides:function(){if(typeof this.slides!="undefined"){var a=this.slides,b;for(b=0;b<a.entries.times.length;b++)if(this.media.currentTime>=
a.entries.times[b].start&&this.media.currentTime<=a.entries.times[b].stop){this.showSlide(b);break}}},displayChapters:function(){var a;for(a=0;a<this.tracks.length;a++)if(this.tracks[a].kind=="chapters"&&this.tracks[a].isLoaded){this.drawChapters(this.tracks[a]);this.hasChapters=true;break}},drawChapters:function(a){var b=this,c,e,d=e=0;b.chapters.empty();for(c=0;c<a.entries.times.length;c++){e=a.entries.times[c].stop-a.entries.times[c].start;e=Math.floor(e/b.media.duration*100);if(e+d>100||c==a.entries.times.length-
1&&e+d<100)e=100-d;b.chapters.append(f('<div class="mejs-chapter" rel="'+a.entries.times[c].start+'" style="left: '+d.toString()+"%;width: "+e.toString()+'%;"><div class="mejs-chapter-block'+(c==a.entries.times.length-1?" mejs-chapter-block-last":"")+'"><span class="ch-title">'+a.entries.text[c]+'</span><span class="ch-time">'+mejs.Utility.secondsToTimeCode(a.entries.times[c].start)+"&ndash;"+mejs.Utility.secondsToTimeCode(a.entries.times[c].stop)+"</span></div></div>"));d+=e}b.chapters.find("div.mejs-chapter").click(function(){b.media.setCurrentTime(parseFloat(f(this).attr("rel")));
b.media.paused&&b.media.play()});b.chapters.show()}});mejs.language={codes:{af:"Afrikaans",sq:"Albanian",ar:"Arabic",be:"Belarusian",bg:"Bulgarian",ca:"Catalan",zh:"Chinese","zh-cn":"Chinese Simplified","zh-tw":"Chinese Traditional",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",et:"Estonian",tl:"Filipino",fi:"Finnish",fr:"French",gl:"Galician",de:"German",el:"Greek",ht:"Haitian Creole",iw:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",ga:"Irish",it:"Italian",ja:"Japanese",
ko:"Korean",lv:"Latvian",lt:"Lithuanian",mk:"Macedonian",ms:"Malay",mt:"Maltese",no:"Norwegian",fa:"Persian",pl:"Polish",pt:"Portuguese",ro:"Romanian",ru:"Russian",sr:"Serbian",sk:"Slovak",sl:"Slovenian",es:"Spanish",sw:"Swahili",sv:"Swedish",tl:"Tagalog",th:"Thai",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",cy:"Welsh",yi:"Yiddish"}};mejs.TrackFormatParser={webvvt:{pattern_identifier:/^([a-zA-z]+-)?[0-9]+$/,pattern_timecode:/^([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,
parse:function(a){var b=0;a=mejs.TrackFormatParser.split2(a,/\r?\n/);for(var c={text:[],times:[]},e,d;b<a.length;b++)if(this.pattern_identifier.exec(a[b])){b++;if((e=this.pattern_timecode.exec(a[b]))&&b<a.length){b++;d=a[b];for(b++;a[b]!==""&&b<a.length;){d=d+"\n"+a[b];b++}d=f.trim(d).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a href='$1' target='_blank'>$1</a>");c.text.push(d);c.times.push({start:mejs.Utility.convertSMPTEtoSeconds(e[1])==0?0.2:mejs.Utility.convertSMPTEtoSeconds(e[1]),
stop:mejs.Utility.convertSMPTEtoSeconds(e[3]),settings:e[5]})}}return c}},dfxp:{parse:function(a){a=f(a).filter("tt");var b=0;b=a.children("div").eq(0);var c=b.find("p");b=a.find("#"+b.attr("style"));var e,d;a={text:[],times:[]};if(b.length){d=b.removeAttr("id").get(0).attributes;if(d.length){e={};for(b=0;b<d.length;b++)e[d[b].name.split(":")[1]]=d[b].value}}for(b=0;b<c.length;b++){var g;d={start:null,stop:null,style:null};if(c.eq(b).attr("begin"))d.start=mejs.Utility.convertSMPTEtoSeconds(c.eq(b).attr("begin"));
if(!d.start&&c.eq(b-1).attr("end"))d.start=mejs.Utility.convertSMPTEtoSeconds(c.eq(b-1).attr("end"));if(c.eq(b).attr("end"))d.stop=mejs.Utility.convertSMPTEtoSeconds(c.eq(b).attr("end"));if(!d.stop&&c.eq(b+1).attr("begin"))d.stop=mejs.Utility.convertSMPTEtoSeconds(c.eq(b+1).attr("begin"));if(e){g="";for(var k in e)g+=k+":"+e[k]+";"}if(g)d.style=g;if(d.start==0)d.start=0.2;a.times.push(d);d=f.trim(c.eq(b).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,
"<a href='$1' target='_blank'>$1</a>");a.text.push(d);if(a.times.start==0)a.times.start=2}return a}},split2:function(a,b){return a.split(b)}};if("x\n\ny".split(/\n/gi).length!=3)mejs.TrackFormatParser.split2=function(a,b){var c=[],e="",d;for(d=0;d<a.length;d++){e+=a.substring(d,d+1);if(b.test(e)){c.push(e.replace(b,""));e=""}}c.push(e);return c}})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{contextMenuItems:[{render:function(a){if(typeof a.enterFullScreen=="undefined")return null;return a.isFullScreen?mejs.i18n.t("Turn off Fullscreen"):mejs.i18n.t("Go Fullscreen")},click:function(a){a.isFullScreen?a.exitFullScreen():a.enterFullScreen()}},{render:function(a){return a.media.muted?mejs.i18n.t("Unmute"):mejs.i18n.t("Mute")},click:function(a){a.media.muted?a.setMuted(false):a.setMuted(true)}},{isSeparator:true},{render:function(){return mejs.i18n.t("Download Video")},
click:function(a){window.location.href=a.media.currentSrc}}]});f.extend(MediaElementPlayer.prototype,{buildcontextmenu:function(a){a.contextMenu=f('<div class="mejs-contextmenu"></div>').appendTo(f("body")).hide();a.container.bind("contextmenu",function(b){if(a.isContextMenuEnabled){b.preventDefault();a.renderContextMenu(b.clientX-1,b.clientY-1);return false}});a.container.bind("click",function(){a.contextMenu.hide()});a.contextMenu.bind("mouseleave",function(){a.startContextMenuTimer()})},cleancontextmenu:function(a){a.contextMenu.remove()},
isContextMenuEnabled:true,enableContextMenu:function(){this.isContextMenuEnabled=true},disableContextMenu:function(){this.isContextMenuEnabled=false},contextMenuTimeout:null,startContextMenuTimer:function(){var a=this;a.killContextMenuTimer();a.contextMenuTimer=setTimeout(function(){a.hideContextMenu();a.killContextMenuTimer()},750)},killContextMenuTimer:function(){var a=this.contextMenuTimer;if(a!=null){clearTimeout(a);delete a}},hideContextMenu:function(){this.contextMenu.hide()},renderContextMenu:function(a,
b){for(var c=this,e="",d=c.options.contextMenuItems,g=0,k=d.length;g<k;g++)if(d[g].isSeparator)e+='<div class="mejs-contextmenu-separator"></div>';else{var j=d[g].render(c);if(j!=null)e+='<div class="mejs-contextmenu-item" data-itemindex="'+g+'" id="element-'+Math.random()*1E6+'">'+j+"</div>"}c.contextMenu.empty().append(f(e)).css({top:b,left:a}).show();c.contextMenu.find(".mejs-contextmenu-item").each(function(){var m=f(this),q=parseInt(m.data("itemindex"),10),p=c.options.contextMenuItems[q];typeof p.show!=
"undefined"&&p.show(m,c);m.click(function(){typeof p.click!="undefined"&&p.click(c);c.contextMenu.hide()})});setTimeout(function(){c.killControlsTimer("rev3")},100)}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{postrollCloseText:mejs.i18n.t("Close")});f.extend(MediaElementPlayer.prototype,{buildpostroll:function(a,b,c){var e=this.container.find('link[rel="postroll"]').attr("href");if(typeof e!=="undefined"){a.postroll=f('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">'+this.options.postrollCloseText+'</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(c).hide();this.media.addEventListener("ended",
function(){f.ajax({dataType:"html",url:e,success:function(d){c.find(".mejs-postroll-layer-content").html(d)}});a.postroll.show()},false)}}})})(mejs.$);
jQuery.extend(jQuery.easing,{def:"ease-in-out",swing:function(t,n,i,e,o){return jQuery.easing[jQuery.easing.def](t,n,i,e,o)},"ease-in":function(t,n,i,e,o){return e*(n/=o)*n+i},"ease-out":function(t,n,i,e,o){return-e*(n/=o)*(n-2)+i},"ease-in-out":function(t,n,i,e,o){return(n/=o/2)<1?e/2*n*n+i:-e/2*(--n*(n-2)-1)+i}});var Pulse=function(){var P={};with(this){!function(t){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],t):t(jQuery)}(function(t){function n(n){return!n||void 0!==n.allowPageScroll||void 0===n.swipe&&void 0===n.swipeStatus||(n.allowPageScroll=c),void 0!==n.click&&void 0===n.tap&&(n.tap=n.click),n||(n={}),n=t.extend({},t.fn.swipe.defaults,n),this.each(function(){var e=t(this),o=e.data(S);o||(o=new i(this,n),e.data(S,o))})}function i(n,i){function C(n){if(!(ln()||t(n.target).closest(i.excludedElements,qn).length>0)){var e,o=n.originalEvent?n.originalEvent:n,s=k?o.touches[0]:o;return Un=x,k?Kn=o.touches.length:n.preventDefault(),On=0,Fn=null,Nn=null,Hn=0,An=0,Ln=0,Rn=1,Qn=0,Xn=pn(),jn=_n(),an(),!k||Kn===i.fingers||i.fingers===v||N()?(un(0,s),Yn=Sn(),2==Kn&&(un(1,o.touches[1]),An=Ln=wn(Xn[0].start,Xn[1].start)),(i.swipeStatus||i.pinchStatus)&&(e=M(o,Un))):e=!1,e===!1?(Un=T,M(o,Un),e):(cn(!0),null)}}function D(t){var n=t.originalEvent?t.originalEvent:t;if(Un!==y&&Un!==T&&!rn()){var e,o=k?n.touches[0]:n,s=hn(o);if(Bn=Sn(),k&&(Kn=n.touches.length),Un=b,2==Kn&&(0==An?(un(1,n.touches[1]),An=Ln=wn(Xn[0].start,Xn[1].start)):(hn(n.touches[1]),Ln=wn(Xn[0].end,Xn[1].end),Nn=bn(Xn[0].end,Xn[1].end)),Rn=xn(An,Ln),Qn=Math.abs(An-Ln)),Kn===i.fingers||i.fingers===v||!k||N()){if(Fn=kn(s.start,s.end),R(t,Fn),On=yn(s.start,s.end),Hn=vn(),gn(Fn,On),(i.swipeStatus||i.pinchStatus)&&(e=M(n,Un)),!i.triggerOnTouchEnd||i.triggerOnTouchLeave){var a=!0;if(i.triggerOnTouchLeave){var r=Cn(this);a=Dn(s.end,r)}!i.triggerOnTouchEnd&&a?Un=z(b):i.triggerOnTouchLeave&&!a&&(Un=z(y)),(Un==T||Un==y)&&M(n,Un)}}else Un=T,M(n,Un);e===!1&&(Un=T,M(n,Un))}}function $(t){var n=t.originalEvent;return k&&n.touches.length>0?(sn(),!0):(rn()&&(Kn=Vn),t.preventDefault(),Bn=Sn(),Hn=vn(),H()?(Un=T,M(n,Un)):i.triggerOnTouchEnd||0==i.triggerOnTouchEnd&&Un===b?(Un=y,M(n,Un)):!i.triggerOnTouchEnd&&B()?(Un=y,O(n,Un,p)):Un===b&&(Un=T,M(n,Un)),cn(!1),null)}function E(){Kn=0,Bn=0,Yn=0,An=0,Ln=0,Rn=1,an(),cn(!1)}function I(t){var n=t.originalEvent;i.triggerOnTouchLeave&&(Un=z(y),M(n,Un))}function P(){qn.unbind(En,C),qn.unbind(Mn,E),qn.unbind(In,D),qn.unbind(Pn,$),zn&&qn.unbind(zn,I),cn(!1)}function z(t){var n=t,e=L(),o=F(),s=H();return!e||s?n=T:!o||t!=b||i.triggerOnTouchEnd&&!i.triggerOnTouchLeave?!o&&t==y&&i.triggerOnTouchLeave&&(n=T):n=y,n}function M(t,n){var i=void 0;return K()||U()?i=O(t,n,h):(j()||N())&&i!==!1&&(i=O(t,n,d)),en()&&i!==!1?i=O(t,n,g):on()&&i!==!1?i=O(t,n,f):nn()&&i!==!1&&(i=O(t,n,p)),n===T&&E(t),n===y&&(k?0==t.touches.length&&E(t):E(t)),i}function O(n,c,u){var _=void 0;if(u==h){if(qn.trigger("swipeStatus",[c,Fn||null,On||0,Hn||0,Kn]),i.swipeStatus&&(_=i.swipeStatus.call(qn,n,c,Fn||null,On||0,Hn||0,Kn),_===!1))return!1;if(c==y&&q()){if(qn.trigger("swipe",[Fn,On,Hn,Kn]),i.swipe&&(_=i.swipe.call(qn,n,Fn,On,Hn,Kn),_===!1))return!1;switch(Fn){case e:qn.trigger("swipeLeft",[Fn,On,Hn,Kn]),i.swipeLeft&&(_=i.swipeLeft.call(qn,n,Fn,On,Hn,Kn));break;case o:qn.trigger("swipeRight",[Fn,On,Hn,Kn]),i.swipeRight&&(_=i.swipeRight.call(qn,n,Fn,On,Hn,Kn));break;case s:qn.trigger("swipeUp",[Fn,On,Hn,Kn]),i.swipeUp&&(_=i.swipeUp.call(qn,n,Fn,On,Hn,Kn));break;case a:qn.trigger("swipeDown",[Fn,On,Hn,Kn]),i.swipeDown&&(_=i.swipeDown.call(qn,n,Fn,On,Hn,Kn))}}}if(u==d){if(qn.trigger("pinchStatus",[c,Nn||null,Qn||0,Hn||0,Kn,Rn]),i.pinchStatus&&(_=i.pinchStatus.call(qn,n,c,Nn||null,Qn||0,Hn||0,Kn,Rn),_===!1))return!1;if(c==y&&Q())switch(Nn){case r:qn.trigger("pinchIn",[Nn||null,Qn||0,Hn||0,Kn,Rn]),i.pinchIn&&(_=i.pinchIn.call(qn,n,Nn||null,Qn||0,Hn||0,Kn,Rn));break;case l:qn.trigger("pinchOut",[Nn||null,Qn||0,Hn||0,Kn,Rn]),i.pinchOut&&(_=i.pinchOut.call(qn,n,Nn||null,Qn||0,Hn||0,Kn,Rn))}}return u==p?(c===T||c===y)&&(clearTimeout(Zn),W()&&!Z()?(Gn=Sn(),Zn=setTimeout(t.proxy(function(){Gn=null,qn.trigger("tap",[n.target]),i.tap&&(_=i.tap.call(qn,n,n.target))},this),i.doubleTapThreshold)):(Gn=null,qn.trigger("tap",[n.target]),i.tap&&(_=i.tap.call(qn,n,n.target)))):u==g?(c===T||c===y)&&(clearTimeout(Zn),Gn=null,qn.trigger("doubletap",[n.target]),i.doubleTap&&(_=i.doubleTap.call(qn,n,n.target))):u==f&&(c===T||c===y)&&(clearTimeout(Zn),Gn=null,qn.trigger("longtap",[n.target]),i.longTap&&(_=i.longTap.call(qn,n,n.target))),_}function F(){var t=!0;return null!==i.threshold&&(t=On>=i.threshold),t}function H(){var t=!1;return null!==i.cancelThreshold&&null!==Fn&&(t=fn(Fn)-On>=i.cancelThreshold),t}function A(){return null!==i.pinchThreshold?Qn>=i.pinchThreshold:!0}function L(){var t;return t=i.maxTimeThreshold?Hn>=i.maxTimeThreshold?!1:!0:!0}function R(t,n){if(i.allowPageScroll===c||N())t.preventDefault();else{var r=i.allowPageScroll===u;switch(n){case e:(i.swipeLeft&&r||!r&&i.allowPageScroll!=_)&&t.preventDefault();break;case o:(i.swipeRight&&r||!r&&i.allowPageScroll!=_)&&t.preventDefault();break;case s:(i.swipeUp&&r||!r&&i.allowPageScroll!=m)&&t.preventDefault();break;case a:(i.swipeDown&&r||!r&&i.allowPageScroll!=m)&&t.preventDefault()}}}function Q(){var t=X(),n=Y(),i=A();return t&&n&&i}function N(){return!!(i.pinchStatus||i.pinchIn||i.pinchOut)}function j(){return!(!Q()||!N())}function q(){var t=L(),n=F(),i=X(),e=Y(),o=H(),s=!o&&e&&i&&n&&t;return s}function U(){return!!(i.swipe||i.swipeStatus||i.swipeLeft||i.swipeRight||i.swipeUp||i.swipeDown)}function K(){return!(!q()||!U())}function X(){return Kn===i.fingers||i.fingers===v||!k}function Y(){return 0!==Xn[0].end.x}function B(){return!!i.tap}function W(){return!!i.doubleTap}function V(){return!!i.longTap}function G(){if(null==Gn)return!1;var t=Sn();return W()&&t-Gn<=i.doubleTapThreshold}function Z(){return G()}function J(){return!(1!==Kn&&k||!isNaN(On)&&0!==On)}function tn(){return Hn>i.longTapThreshold&&w>On}function nn(){return!(!J()||!B())}function en(){return!(!G()||!W())}function on(){return!(!tn()||!V())}function sn(){Wn=Sn(),Vn=event.touches.length+1}function an(){Wn=0,Vn=0}function rn(){var t=!1;if(Wn){var n=Sn()-Wn;n<=i.fingerReleaseThreshold&&(t=!0)}return t}function ln(){return!(qn.data(S+"_intouch")!==!0)}function cn(t){t===!0?(qn.bind(In,D),qn.bind(Pn,$),zn&&qn.bind(zn,I)):(qn.unbind(In,D,!1),qn.unbind(Pn,$,!1),zn&&qn.unbind(zn,I,!1)),qn.data(S+"_intouch",t===!0)}function un(t,n){var i=void 0!==n.identifier?n.identifier:0;return Xn[t].identifier=i,Xn[t].start.x=Xn[t].end.x=n.pageX||n.clientX,Xn[t].start.y=Xn[t].end.y=n.pageY||n.clientY,Xn[t]}function hn(t){var n=void 0!==t.identifier?t.identifier:0,i=dn(n);return i.end.x=t.pageX||t.clientX,i.end.y=t.pageY||t.clientY,i}function dn(t){for(var n=0;n<Xn.length;n++)if(Xn[n].identifier==t)return Xn[n]}function pn(){for(var t=[],n=0;5>=n;n++)t.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return t}function gn(t,n){n=Math.max(n,fn(t)),jn[t].distance=n}function fn(t){return jn[t]?jn[t].distance:void 0}function _n(){var t={};return t[e]=mn(e),t[o]=mn(o),t[s]=mn(s),t[a]=mn(a),t}function mn(t){return{direction:t,distance:0}}function vn(){return Bn-Yn}function wn(t,n){var i=Math.abs(t.x-n.x),e=Math.abs(t.y-n.y);return Math.round(Math.sqrt(i*i+e*e))}function xn(t,n){var i=n/t*1;return i.toFixed(2)}function bn(){return 1>Rn?l:r}function yn(t,n){return Math.round(Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2)))}function Tn(t,n){var i=t.x-n.x,e=n.y-t.y,o=Math.atan2(e,i),s=Math.round(180*o/Math.PI);return 0>s&&(s=360-Math.abs(s)),s}function kn(t,n){var i=Tn(t,n);return 45>=i&&i>=0?e:360>=i&&i>=315?e:i>=135&&225>=i?o:i>45&&135>i?a:s}function Sn(){var t=new Date;return t.getTime()}function Cn(n){n=t(n);var i=n.offset(),e={left:i.left,right:i.left+n.outerWidth(),top:i.top,bottom:i.top+n.outerHeight()};return e}function Dn(t,n){return t.x>n.left&&t.x<n.right&&t.y>n.top&&t.y<n.bottom}var $n=k||!i.fallbackToMouseEvents,En=$n?"touchstart":"mousedown",In=$n?"touchmove":"mousemove",Pn=$n?"touchend":"mouseup",zn=$n?null:"mouseleave",Mn="touchcancel",On=0,Fn=null,Hn=0,An=0,Ln=0,Rn=1,Qn=0,Nn=0,jn=null,qn=t(n),Un="start",Kn=0,Xn=null,Yn=0,Bn=0,Wn=0,Vn=0,Gn=0,Zn=null;try{qn.bind(En,C),qn.bind(Mn,E)}catch(Jn){t.error("events not supported "+En+","+Mn+" on jQuery.swipe")}this.enable=function(){return qn.bind(En,C),qn.bind(Mn,E),qn},this.disable=function(){return P(),qn},this.destroy=function(){return P(),qn.data(S,null),qn},this.option=function(n,e){if(void 0!==i[n]){if(void 0===e)return i[n];i[n]=e}else t.error("Option "+n+" does not exist on jQuery.swipe.options");return null}}var e="left",o="right",s="up",a="down",r="in",l="out",c="none",u="auto",h="swipe",d="pinch",p="tap",g="doubletap",f="longtap",_="horizontal",m="vertical",v="all",w=10,x="start",b="move",y="end",T="cancel",k="ontouchstart"in window,S="TouchSwipe",C={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"label, button, input, select, textarea, a, .noSwipe"};t.fn.swipe=function(i){var e=t(this),o=e.data(S);if(o&&"string"==typeof i){if(o[i])return o[i].apply(this,Array.prototype.slice.call(arguments,1));t.error("Method "+i+" does not exist on jQuery.swipe")}else if(!(o||"object"!=typeof i&&i))return n.apply(this,arguments);return e},t.fn.swipe.defaults=C,t.fn.swipe.phases={PHASE_START:x,PHASE_MOVE:b,PHASE_END:y,PHASE_CANCEL:T},t.fn.swipe.directions={LEFT:e,RIGHT:o,UP:s,DOWN:a,IN:r,OUT:l},t.fn.swipe.pageScroll={NONE:c,HORIZONTAL:_,VERTICAL:m,AUTO:u},t.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:v}});var _ns={},_handles="fullscreen item itemnext contentclick contentmouseover contentmousemove contentmouseout dataloaded hasloaded waiting transition transitionstart transitionend playing built playbacktimer resizecomplete ended start ready videobegin videoend";_bind=function(t){var n=this;_handles.indexOf(t.type)<0||this.contentContainer.bind(t.type,function(i,e){if(i="boolean"==typeof e||e instanceof Array?e:$.extend({},i,e),t.type==n.triggered){if(!t.fn)return;if("transition"===t.type)t.fn.call(n.container,{current:n.last,next:n.current,forward:n.forward},t.type);else if("playing"===t.type)t.fn.call(n.container,"playing"===n.state?!0:!1,t.type);else{if(i.nodeType&&"transitionend"===t.type)return;t.fn.call(n.container,i.nodeType?$(i):i,t.type)}}})},_queue=function(t){t=t||!1;var n=[],i=this;return{add:function(t){return n.push(t),this},load:function(){for(var e=n.length,o=0;e>o;o++){var s=n[o],a=s.priority||i.loadQueue.internal.length;delete s.priority,t?(s.node.bind("load",function(){_popQueue.call(i)}),i.loadQueue.external.push(s)):1===a?i.loadQueue.internal.unshift(s):i.loadQueue.internal.splice(a,0,s)}n=[],_popQueue.call(i)}}},_popQueue=function(){var t=this.loadQueue.internal.shift();if(!t){if(!this.loadQueue.canLoadExternal)return;t=this.loadQueue.external.shift()}t?t.node?t.node.attr("src",t.src):_popQueue.call(this):(clearInterval(this.loadQueue.interval),this.loadQueue.interval=!1)},_hasLoaded=function(t){var n,i=t.parent("div.pulse-content-container");i.length&&i.data("asset")&&(n=i.data("asset").index),t.addClass("loaded"),n!==this.options.index||0!=i.parent("div").css("opacity")&&!this.options.touchSwipe||(this.contentContainer.trigger(this.triggered="waiting",[!1]),_display.call(this)),this.contentContainer.trigger(this.triggered="hasloaded"),_popQueue.call(this)},_loadItemById=function(t){var n=this.idMap[t];_loadItemByIndex(n)},_loadItemByIndex=function(t,n){n=n||!1,n||_pause.call(this),t<this.options.index?t=-(this.options.index-t):t-=this.options.index,_update.call(this,t,n)},_get=function(t){return this.contentContainer.find('div[data-pulse-container="'+t+'"]')},_pause=function(){this.state="paused",clearTimeout(this.playTimer.id),this.contentContainer.trigger(this.triggered="playing")},_play=function(){this.state="playing",_update.call(this,1),this.contentContainer.trigger(this.triggered="playing")},_options=function(){return this.options},_toggle=function(){this.firstTime=!1,"playing"==this.state?_pause.call(this):_play.call(this)},_toggleFullScreen=function(){var t=Pulse.fullScreenApi;if(t.isFullScreen())this.lastHeight&&this.contentContainer.css("height",this.lastHeight),t.cancelFullScreen(),this.contentContainer.trigger(this.triggered="fullscreen",[!1]);else{this.lastHeight=this.contentContainer.css("height");var n=this.container.children(":not(.pulse-main-container)").height();this.contentContainer.css("height","-webkit-calc(100% - "+n+"px)"),this.contentContainer.css("height","-moz-calc(100% - "+n+"px)"),this.contentContainer.css("height","-ms-calc(100% - "+n+"px)"),this.contentContainer.css("height","-o-calc(100% - "+n+"px)"),this.contentContainer.css("height","calc(100% - "+n+"px)"),t.requestFullScreen(this.options.fullScreenRoot[0]),this.contentContainer.trigger(this.triggered="fullscreen",[!0])}},_startPlaybackTimer=function(){if("undefined"==typeof this.firstTime&&!this.options.autostart)return this.firstTime=!1,void 0;if("playing"===this.state){var t=this,n=+new Date,i={total:this.options.speed};this.playTimer.remaining=this.playTimer.remaining||this.options.speed,clearInterval(this.playTimer.id),this.playTimer.id=setInterval(function(){var e=+new Date;t.playTimer.remaining-=e-n,n=e,i.remaining=Math.max(t.playTimer.remaining,0),i.totalItems=t.totalItems,t.contentContainer.trigger(t.triggered="playbacktimer",i),t.playTimer.remaining<=0&&_update.call(t,1)},50)}},_exists=function(t){var n=$.inArray(t,this.handlers);return-1===n?!1:this.handlers[n]},_loadPreset=function(t,n){n=n||!1;var i,e={width:t.width(),height:t.height()},o=!1,s=t.data("asset"),a={},r=t.find("img.pulse-content-image"),l=Math.max(Math.abs(this.options.index-s.index),1);t.removeClass("loaded");for(var c in s.presets)if(i=s.presets[c],"expand"===this.options.size&&i.width>e.width||i.width>e.width&&i.height>e.height){o=window.$K&&$K.isRetina()?i.hidpi_url:i.url,a.width=i.width,a.height=i.height;break}o||(o=$K.isRetina()?i.hidpi_url:i.url),t.data("size",a);var u={node:r,src:o,priority:l};return n?(_queue.call(this).add(u).load(),void 0):u},_load=function(){var t,n,e=[this.loaded[this.options.index].id],o=this,s=this.touchContainer||this.contentContainer;for(i=1;i<=this.cushion;i++)t=this.options.index-i,0>t&&(t=this.loaded.length+t),this.loaded[t]&&(_get.call(this,this.loaded[t].id).length<=0&&s.append(_build.call(this,t)),e.push(this.loaded[t].id));for(_get.call(this,this.loaded[this.options.index].id).length<=0&&s.append(_build.call(this,this.options.index)),i=1;i<=this.cushion;i++)n=this.options.index+i,n>=this.loaded.length&&(n-=this.loaded.length),this.loaded[n]&&(_get.call(this,this.loaded[n].id).length<=0&&s.append(_build.call(this,n)),e.push(this.loaded[n].id));var a=_queue.call(this);this.contentContainer.find("div.pulse-content-container").each(function(){var t=$(this),n=t.find("img.pulse-content-image"),i=t.data("asset"),s=t.parent(),r=i&&i.id;-1===$.inArray(r,e)?(n.attr("src",""),s.remove()):n.hasClass("loaded")||a.add(_loadPreset.call(o,t))}),a.load()},_ratio=function(t,n){n&&(this.realDims={width:t.parents("div").width(),height:t.parents("div").height()},t=t.data("asset"));var i="expand"!==this.options.size||1/0===this.options.maxHeight?this.realDims.height:this.options.maxHeight;return this.containerRatio=this.containerRatio&&this.containerRatio<1/0?this.containerRatio:this.realDims.width/i,t.aspect_ratio>=this.containerRatio?{w:this.realDims.width,h:Math.round(this.realDims.width/t.aspect_ratio)}:{w:Math.round(i*t.aspect_ratio),h:i}},_kill=function(){this.dead=!0,this.contentContainer.off(),this.state="paused",clearInterval(this.loadQueue.interval),clearTimeout(this.playTimer.id);var t=this.container.attr("id");delete _ns[t],$.each(_ns.all,function(n,i){i&&i.container.attr("id")===t&&_ns.all.splice(n,1)})},_update=function(t,n){if(n=n||!1,!this.transitioning){var i=parseInt(this.options.index,10)+t;if(clearInterval(this.playTimer.id),this.playTimer.remaining=!1,0>t&&!n?(_pause.call(this),this.forward=!1):this.forward=!0,this.loaded.length<=1||this.options&&this.options.loop===!1&&i>=this.loaded.length)return this.contentContainer.trigger(this.triggered="ended"),void 0;this.options.index=0>i?this.loaded.length-1:i>=this.loaded.length?0:i;var e=_get.call(this,this.loaded[this.options.index].id);e.length?e.find("img.pulse-content-image").hasClass("loaded")?_display.call(this):(this.contentContainer.trigger(this.triggered="waiting",[!0]),_loadPreset.call(this,e.find("div.pulse-content-container"),!0)):(this.contentContainer.trigger(this.triggered="waiting",[!0]),e=_build.call(this,this.options.index),this.contentContainer.append(e),_loadPreset.call(this,e.find("div.pulse-content-container"),!0))}},_getItem=function(){return this.currentData},_getNextItem=function(){var t=this.options.index+1;return t>=this.loaded.length&&this.options.loop===!0&&(t=0),this.loaded[t]||!1},_display=function(){if(this.transitioning=!0,this.current&&this.current.css("z-index",9),this.currentData=this.loaded[this.options.index],this.current=_get.call(this,this.currentData.id),"expand"===this.options.size){var t=Math.min(this.options.maxHeight,this.realDims.width/this.currentData.aspect_ratio);this.contentContainer.animate({height:t},0===this.realDims.height||"none"===this.options.transition_type?0:this.options.transition_duration),this.realDims.height=t}if(this.current.css("z-index",10),this.last?(this.last.find(".video-container").css({left:-1e4}),this.last.find("img.pulse-content-image").show()):this.options.autostart===!0&&(this.state="playing",this.contentContainer.trigger(this.triggered="playing")),this.contentContainer.trigger(this.triggered="transitionstart",{dom:this.current,data:this.currentData}),this.contentContainer.trigger(this.triggered="itemnext",{dom:this.current,data:this.currentData}),this.options.next&&!this.options.loop){var n=$(this.options.next);n.length&&(this.currentData.is_last?n.addClass("k-pulse-button-disabled"):n.removeClass("k-pulse-button-disabled"))}if(this.options.previous&&!this.options.loop){var i=$(this.options.previous);i.length&&(this.currentData.is_first?i.addClass("k-pulse-button-disabled"):i.removeClass("k-pulse-button-disabled"))}this.loadQueue.canLoadExternal=!0,this.contentContainer.trigger(this.triggered="transition",this.current),this.last=this.current;var e=this.current.find(".video-container");e.length&&this.currentData.html&&e.css("left","50%")},_build=function(t){var n=this.loaded[t],i=$('<div data-pulse-container="'+n.id+'" />'),e=$("<div />"),o=$("<div />").addClass("pulse-content-ui-container").css("position","absolute"),s=$("<img />").addClass("pulse-content-image"),a=this;n.index=t,n.position=t+1,n.total=this.totalItems,n.is_first=1===n.position,n.is_last=n.position===this.totalItems,i.css({position:"absolute",background:this.options.background,width:"100%",height:"100%",top:0,left:0,right:"auto",bottom:"auto",opacity:0,margin:0,padding:0,border:0,overflow:"hidden",zIndex:9});var r=_position.call(this,n);if(e.addClass("pulse-content-container").css({position:"absolute",width:r.width,height:r.height,left:r.left,top:r.top}).data("asset",n),r.cropped?o.css({width:a.container.width(),height:a.container.height(),top:-r.top,left:-r.left}):o.css({width:"100%",height:"100%"}),s.attr({alt:n.title||n.filename,width:"100%",height:"100%","data-longest-side":Math.max(n.width,n.height),"data-visibility":n.visibility.raw}).css({position:"absolute",top:0,left:0}).one("load",function(){_hasLoaded.call(a,$(this))}),e.append(s),"video"===n.file_type){var l;n.html?(l=$(n.pulse_html||n.html),l.attr({width:"100%",height:"100%"}).css({position:"absolute",top:0,left:0}).appendTo(e)):l=$("<video/>").css({position:"absolute",top:0,left:0,width:"100%",height:"100%"}).attr({width:"100%",height:"100%",src:n.original.url});var c=$("<div/>").addClass("video-container").css({position:"absolute",top:"50%",left:"-10000px",width:n.html?"80px":"100%",height:n.html?"80px":"100%",margin:n.html?"-40px 0 0 -40px":0,opacity:.001,zIndex:n.html?1e4:1});c.append(l),e.append(c);var u=$("<div/>").addClass("video-overlay").css({position:"absolute",top:0,left:0,width:"100%",height:"100%",display:n.html?"none":"block",zIndex:2}).append($("<div/>").addClass("mejs-overlay-button").bind("click touchstart",function(t){t.preventDefault(),t.stopPropagation(),c.data("player").play(),_crop.call(a,n.aspect_ratio)&&e.find(".mejs-controls").css({width:i.width(),left:Math.abs(a.realDims.width/2-i.find(".pulse-content-container").width()/2)});var o=a.container.attr("id");_ns[o].triggers.videoStart.call(a)}));e.append(u),n.html||requestAnimationFrame(function(){$(l).mediaelementplayer({pluginPath:$K.location.real_root_folder+"/app/site/themes/common/js/",success:function(t){c.data("player",t);var n=a.container.attr("id");t.addEventListener("ended",function(){_ns[n].triggers.videoEnd.call(a)}),t.addEventListener("pause",function(){_ns[n].triggers.videoPause.call(a)})}})})}return e.append(o),i.append(e),this.contentContainer.trigger(this.triggered="built",{dom:i,data:n}),i},_data=function(t){t=t||!1;var n=function(t){function n(t){for(var n=t.length-1;n>0;n--){var i=Math.floor(Math.random()*(n+1)),e=t[n];t[n]=t[i],t[i]=e}return t}var i=t.album||!1;if(!t.content)if(t.covers)t.content=t.covers;else{if(!t.albums)return;"random"===this.options.order&&(t.albums=n(t.albums));var e=[];i=[],$.each(t.albums,function(t,n){e.push(n.covers[0]),i.push(n)}),t.content=e}if("random"!==this.options.order||t.albums||(t.content=n(t.content)),this.options.index>t.total-1&&(this.options.index=0),0===t.total)return this.contentContainer.trigger(this.triggered="dataloaded",{items:!1,source:t.site_link||!1}),this.options.fallbackText?(this.container.html('<span class="k-note k-note-pulse" style="display:block;">'+this.options.fallbackText+"</span>"),this.container.get(0).style.height.length&&this.container.find(".k-note").css("line-height",this.container.outerHeight(!0)+"px"),this.container.addClass("k-pulse-no-data")):this.options.fallbackElement&&(this.container.hide(),this.options.fallbackElement.show()),void 0;var o=!1,s=!1;0===this.totalItems&&((t.album||t.albums)&&(this.options.can_link_to_album=!0),"album"===this.options.link_to&&t.album&&(this.options.link_to=t.album.__koken_url),"album"===this.options.link_to&&t.albums&&(this.originalData=t,this.options.link_to="albums"),this.options.dataUrl.match(/limit:[0-9]+/)?(s=!0,this.totalItems=t.content.count):this.totalItems=t.total,this.cushion=Math.max(this.totalItems<2*this.cushion+1?Math.floor((this.totalItems-.5)/2):this.cushion,1),o=!0);var a,r;for(a=0,r=t.content.length;r>a;a++)if(t.content[a].presets){var l=t.content[a];l.parent=$.isArray(i)?i[a]:i,this.loaded.push(l),this.idMap[t.content[a].id]=this.loaded.length-1}if("auto"===this.options.size){var c=0,u=0;$.each(t.content,function(t,n){isNaN(n.aspect_ratio)||(c+=n.aspect_ratio,u++)});var h,d=c/u,p=1/0,g=["1:10","2:10","3:10","4:10","5:10","6:10","7:10","8:10","9:10","10:10","10:9","10:8","10:7","10:6","10:5","10:4","10:3","10:2","10:1","4:3","3:4","3:2","2:3","1:1","16:9"];$.each(g,function(t,n){var i=n.split(":"),e=i[0]/i[1],o=Math.abs(d-e);p>o&&(h=n,p=o)}),this.options.size=h,_setSize.call(this),_resize.call(this)}this.contentContainer.trigger(this.triggered="dataloaded",{items:t.content,source:t.site_link||!1}),o&&(this.options.album_type=t.album?t.album.album_type:t.album_type?t.album_type:!1,this.options.album_id=t.album?t.album.id:t.id?t.id:!1,this.contentContainer.trigger(this.triggered="waiting",[!0]),_load.call(this),this.contentContainer.trigger(this.triggered="ready",this.container)),t.page<t.pages&&!s&&(this.options.dataUrl=this.options.dataUrl.replace(/\/page:[0-9]+/,"")+"/page:"+(t.page+1),_data.call(this))};if(t)n.call(this,t);else{var i=this;$.ajax({url:this.options.dataUrl,dataType:"json",success:function(t){n.call(i,t)}})}},_event=function(t,n,i,e){var o=this;$(document).on(n,t,{},function(t){this.forward=0>e?!1:!0,i.call(o,e,t),t.preventDefault()})},_resizePresets=function(){var t=_queue.call(this),n=this;this.contentContainer.find("div.pulse-content-container").each(function(){var i=$(this),e=i.data("size");"object"==typeof e&&(n.realDims.width>e.width||n.realDims.height>e.height)&&t.add(_loadPreset.call(n,i))}),t.load()},_position=function(t){0===this.realDims.height&&this.options.height&&-1!==this.options.height.indexOf("%")&&_resize.call(this);var n,i,e=this.realDims.width,o="expand"!==this.options.size||1/0===this.options.maxHeight?this.realDims.height:this.options.maxHeight,s=Math.round(e/t.aspect_ratio),a=_crop.call(this,t.aspect_ratio);if(a)o>s&&(s=o,e=Math.round(s*t.aspect_ratio)),i=Math.min(0,Math.max(-(e-this.realDims.width),this.realDims.width/2-e/(100/t.focal_point.x))),n=Math.min(0,Math.max(-(s-o),o/2-s/(100/t.focal_point.y)));else if("expand"!==this.options.size||s>this.options.maxHeight){o="expand"===this.options.size?this.options.maxHeight:o;var r=_ratio.call(this,t);e=r.w,s=r.h,i=this.realDims.width/2-e/2,n=o/2-s/2}return{width:e,height:s,left:i,top:n,cropped:a}},_crop=function(t){var n=1>t,i=this.containerRatio<1;return"fill"===this.options.crop||"adaptive"===this.options.crop&&n===i||"portrait"===this.options.crop&&n||"landscape"===this.options.crop&&!n},_resize=function(){if(!this.dead){var t=this;if(this.options.autoHeight&&this.contentContainer.css({height:this.container.width()*this.options.autoHeight}),this.options.maxHeightAuto&&(this.options.maxHeight=this.container.width()),"expand"===this.options.size&&this.currentData&&this.contentContainer.css("height",Math.min(this.options.maxHeight,this.container.width()/this.currentData.aspect_ratio)),this.realDims={width:this.contentContainer.width(),height:this.contentContainer.height()},0===this.realDims.width&&Pulse.fullScreenApi.isFullScreen())return this.options.fullScreenRoot.css("width","100%"),_resize.call(this),void 0;this.containerRatio=this.realDims.width/this.realDims.height,(-1!==this.options.width.toString().indexOf("%")||-1!==this.options.height.toString().indexOf("%"))&&(window.clearTimeout(this.resizeInterval),this.resizeInterval=window.setTimeout(function(){_resizePresets.call(t)},500)),this.contentContainer.find("div.pulse-content-container").each(function(){var n=$(this);if(n.data("asset")){var i=_position.call(t,n.data("asset"));n.css({width:i.width,height:i.height,left:i.left,top:i.top});var e=n.find("video");e.length&&e[0].player&&(e=e[0].player,e.setPlayerSize(i.width,i.height),e.setControlsSize(),"native"!==e.pluginType&&e.media.setVideoSize&&e.media.setVideoSize(i.width,i.height),_crop.call(t,n.data("asset").aspect_ratio)&&n.find(".mejs-controls").css({width:t.realDims.width,left:Math.abs(i.left)}));var o=n.find(".pulse-content-ui-container");i.cropped?o.css({width:t.container.width(),height:t.container.height(),top:-i.top,left:-i.left}):o.css({width:"100%",height:"100%"})}});var n=this.container.find(".k-note");n.length&&n.outerHeight()!==this.container.height()&&n.css("line-height",this.container.height()+"px")}},_clone=function(t){if(!t)return!1;var n=$(t[0].cloneNode(!0));return n.find("[data-node-uid]").removeAttr("data-node-uid"),n},_setSize=function(){var t="auto"===this.options.size?"3:2":this.options.size,n=t.split(":");this.options.height=n[1]+"/"+n[0];var i,e=this.options.height.split("/"),o=e[0]/e[1];return i=isNaN(this.options.width)?this.container.parent().width()*o:this.options.width*o,this.options.autoHeight=o,i},_setup=function(t,n){var i=$(t),e=i.attr("id");if(_ns[e]={},_ns[e].context=i,_ns[e].container=i,_ns[e].dead=!1,_ns[e].parent=i.parent(),_ns[e].platform=window.onorientationchange?4:10,_ns[e].handlers=[],_ns[e].loaded=[],_ns[e].triggers=[],_ns[e].touch={},_ns[e].playTimer={id:0,remaining:!1},_ns[e].cushion=3,_ns[e].realDims={},_ns[e].forward=!0,_ns[e].transitioning=!1,_ns[e].touch={},_ns[e].totalItems=0,_ns[e].idMap={},_ns[e].loadQueue={internal:[],external:[],canLoadExternal:!1,interval:!1},_ns[e].stack=0,_ns[e].fsElWidth=0,_ns[e].options={},_ns[e].options.album_id=!1,_ns[e].options.album_type=!1,_ns[e].options.width=n&&n.width?n.width:"100%",_ns[e].options.height=n&&n.height?n.height:!1,_ns[e].options.background=n&&n.background||_ns[e].container.css("background"),_ns[e].options.speed=1e3*(n&&n.speed||5),_ns[e].options.index=n&&n.index||0,_ns[e].options.crop=n&&n.crop||"none",_ns[e].options.dataUrl=n&&n.dataUrl||"/api.php?/content",_ns[e].options.autoHeight=!1,_ns[e].options.size=n&&n.size&&("auto"===n.size||"expand"===n.size||n.size.indexOf(":")>0)&&n.size||!1,_ns[e].options.maxHeight=parseInt(i.css("max-height"),10),_ns[e].options.maxHeightAuto=!1,_ns[e].options.allowFullScreen=n&&n.hasOwnProperty("allowfullscreen")?n.allowfullscreen:!0,_ns[e].options.fullScreenRoot=n&&n.fullscreenroot&&$(n.fullscreenroot)||_ns[e].container,_ns[e].options.fallbackText=n&&n.fallbacktext||!1,_ns[e].options.fallbackElement=n&&n.fallbackelement?$(n.fallbackelement):!1,_ns[e].options.link_to=n&&"false"!==n.link_to&&n.link_to,_ns[e].options.transition_duration=n&&n.transition_duration||"500ms",_ns[e].options.data=n.data||!1,_ns[e].options.order=n&&n.random===!0?"random":"default",_ns[e].options.album_url=n.albumUrl||!1,_ns[e].options.can_link_to_album=n.can_link_to_album||!1,_ns[e].options.touchSwipe=void 0!==n.swipe?n.swipe:!0,_ns[e].options.touchSwipe&&("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)){var o=["Webkit","Moz","O","ms",""],s=!1;o.forEach(function(t){return t+"Transform"in document.body.style?(s=t,!1):void 0}),s?(s.length&&(s="-"+s.toLowerCase()+"-"),_ns[e].options.touchSwipePrefix=s):_ns[e].options.touchSwipe=!1}else _ns[e].options.touchSwipe=!1;_ns[e].options.touchSwipe&&(_ns[e].cushion=2),_ns[e].options.transition_duration=function(){var t=_ns[e].options.transition_duration,n=parseFloat(t,10),i=parseInt(t,10);return 0===n?0:(n>0&&i.toString().length<=2&&(t+="s"),/\dms$/.test(t)?parseInt(t,10):/\ds$/.test(t)?1e3*parseFloat(t,10):t)}(),_ns[e].options.link_to&&-1!==$.inArray(n.link_to,["lightbox","content","album"])&&!window.$K&&(_ns[e].options.link_to=!1),isNaN(_ns[e].options.maxHeight)&&(_ns[e].options.maxHeight=i.width(),_ns[e].options.maxHeightAuto=!0),_ns[e].options.size||_ns[e].options.height||(_ns[e].options.size="3:2");var a=_ns[e].options.height;_ns[e].options.size&&"expand"!==_ns[e].options.size&&(a=_setSize.call(_ns[e])),n&&(_ns[e].options.transition=n.transition_type?n.transition_type:"dissolve",_ns[e].options.transition_easing=n.transition_easing?n.transition_easing:"ease-in-out",_ns[e].options.loop="undefined"==typeof n.loop?!0:n.loop,_ns[e].options.autostart="undefined"==typeof n.autostart?!0:n.autostart,n.next&&_event.call(_ns[e],n.next,"click",function(){(this.options.loop||!this.currentData.is_last)&&_update.call(this,1)}),n.previous&&_event.call(_ns[e],n.previous,"click",function(){(this.options.loop||!this.currentData.is_first)&&_update.call(this,-1)}),n.restart&&_event.call(_ns[e],n.restart,"click",function(){_loadItemByIndex.call(this,0,!0)}),n.toggle&&_event.call(_ns[e],n.toggle,"click",_toggle),n.play&&_event.call(_ns[e],n.play,"click",_play),n.pause&&_event.call(_ns[e],n.pause,"click",_pause),n.pause&&_event.call(_ns[e],n.pause,"click",_pause),n.fullscreen&&(Pulse.fullScreenApi.supportsFullScreen?_event.call(_ns[e],n.fullscreen,"click",_toggleFullScreen):$(n.fullscreen).addClass("k-pulse-button-disabled"))),_ns[e].container.css({background:_ns[e].options.background,position:"relative",width:_ns[e].options.width}),"expand"===_ns[e].options.size?a=0:-1!==String(a).indexOf("%")&&_ns[e].container.css("height",a),_ns[e].contentContainer=$("<div/>").css({width:_ns[e].options.width,height:a,position:"relative"}).attr("class","pulse-main-container"),_ns[e].options.link_to&&_ns[e].contentContainer.css("cursor","pointer");
var r=["click","mousedown","mouseover","mousemove","mouseout"];if(_ns[e].options.touchSwipe){var i=_ns[e];_ns[e].contentContainer.css("overflow","hidden"),_ns[e].touchContainer=$("<div/>").css({height:"100%",position:"relative"}).bind("webkitTransitionEnd mozTransitionEnd msTransitionEnd oTransitionEnd transitionend",function(){if($(this).css(i.options.touchSwipePrefix+"transition",""),i.options.transition_duration="500ms",i.transitioning){if(_load.call(i),i.current.css("left",0),$(this).css(i.options.touchSwipePrefix+"transform","translate3d(0,0,0)"),1===i.totalItems)return;for(var t=i.totalItems<5?i.options.index-1:i.options.index-2,n=i.totalItems<5?i.options.index+(i.totalItems-1):i.options.index+3,e=t;n>e;e++)if(e!==i.options.index){var o=e<i.options.index,s=e,a=Math.abs(s-i.options.index);s>=i.loaded.length&&(s-=i.loaded.length),0>s&&(s=i.loaded.length+s);var r=i.loaded[s];r&&_get.call(i,r.id).css({left:(o?"-":"")+100*a+"%",opacity:1})}requestAnimationFrame(function(){i.triggers.transitionEnd.call(i)})}}).attr("class","pulse-touch-container").appendTo(_ns[e].contentContainer);var l={start:{x:0,y:0},end:{x:null,y:null},move:!1};_ns[e].contentContainer.bind("touchstart touchmove touchend",function(t){i.options.transition_duration="500ms";var n=t.originalEvent.targetTouches[0];switch(t.type){case"touchstart":l.start.x=n.pageX,l.start.y=n.pageY,l.start.time=+new Date,l.end.x=null,l.move=!1;break;case"touchmove":l.end.x=n.pageX,l.end.y=n.pageY;var o=l.start.x-l.end.x,s=l.start.y-l.end.y;Math.abs(o/2)>Math.abs(s)&&(clearTimeout(i.playTimer.id),t.stopPropagation(),t.preventDefault(),l.move=!0,i.touchContainer.css(i.options.touchSwipePrefix+"transform","translate3d("+-o+"px,0,0)"));break;case"touchend":if(l.move){t.stopPropagation(),t.preventDefault();var a=l.start.x-l.end.x,r=0>a?-1:1;a=Math.abs(a);{var c=i.contentContainer.width(),u=+new Date,h=u-l.start.time,d=h/a,p=c-a;i.options.index+r}a>.07*c&&i.totalItems>1?(i.options.transition_duration=Math.min(500,Math.round(p*d))+"ms",_update.call(i,r)):_display.call(i)}else null===l.end.x&&(t.stopPropagation(),t.preventDefault(),_ns[e].contentContainer.trigger("click"))}})}else _ns[e].contentContainer.swipe({swipe:function(t,n){var i=_ns[$(t.target).closest(".pulse-content-container").closest(".pulse-main-container").parent().attr("id")];"left"===n?_update.call(i,1):"right"===n&&_update.call(i,-1)},allowPageScroll:"vertical"}),r.concat(["touchstart","touchmove","touchend"]);return _ns[e].contentContainer.bind(r.join(" "),function(t){if("mousedown"===t.type){if(-1===$.inArray(t.target.tagName.toLowerCase(),["embed","object","video"]))return;t.type="click"}var n=$(t.target),i=!1;if(n.hasClass("pulse-main-container")?i=n:n.closest(".pulse-content-container").closest(".pulse-main-container").parent().length>0&&(i=n.closest(".pulse-content-container").closest(".pulse-main-container")),i){var e=_ns[i.parent().attr("id")],o=_exists.call(e,"content"+t.type);if(o){var s={dom:e.current,data:e.currentData};if(-1===t.type.indexOf("touch")){var a=e.contentContainer.offset(),r=t.pageX-a.left,l=a.top-t.pageY;s.cursor={percentageX:Math.abs(Math.round(100*(r/e.contentContainer.width()).toFixed(2))),percentageY:Math.abs(Math.round(100*(l/e.contentContainer.height()).toFixed(2)))}}e.contentContainer.trigger(e.triggered="content"+t.type,s)}if("click"===t.type&&e.options.link_to){{var c,u=(e.options.dataUrl,!1);window.$K?window.$K.location.defaults:!1}if(e.options.data&&e.options.data.album_id?u=e.options.data.album_id:e.options.album_id&&(u=e.options.album_id),t.originalEvent&&"video"===t.originalEvent.target.tagName.toLowerCase())return;var h=location.href.match(/&preview=.*/)||"";switch(e.options.link_to){case"advance":return _update.call(e,1),void 0;case"playback":return _toggle.call(e),void 0;case"lightbox":case"content":if(c=e.currentData.__koken_url,"lightbox"===e.options.link_to&&!/\/lightbox\/$/.test(c))return c=$K.location.root+c+"lightbox/"+h,_pause.call(e),$K.lightbox.load(c),void 0;break;case"albums":c=e.originalData.albums[e.options.index].__koken_url;break;case"album":var d=RegExp(e.options.album_url.replace(/:[a-z_]+/,"[^/]+"));c=e.currentData.__koken_url&&d.test(e.currentData.__koken_url)?e.currentData.__koken_url.match(d)[0]:!1;break;default:c=e.options.link_to}c&&(location.href=(-1===c.indexOf("http://")?window.$K.location.root:"")+c+(-1===c.indexOf("http://")?h:""))}}}),_ns[e].container.append(_ns[e].contentContainer),_ns[e].realDims={width:_ns[e].contentContainer.width(),height:_ns[e].contentContainer.height()},$(window).bind("orientationchange resize webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){(!_ns.all||_ns.all.length<$(".pulse-main-container").length)&&(_ns.all=[],$(".pulse-main-container").each(function(t,n){_ns.all.push(_ns[$(n).parent().attr("id")])}));for(var t=0,n=_ns.all.length;n>t;t++){var i,e=_ns.all[t];if(i&&clearTimeout(i),!e)return;i=setTimeout(function(){e.contentContainer.trigger(e.triggered="resizecomplete")},200),_resize.call(e)}}).trigger("resize"),_ns[e].triggers={},_ns[e].triggers.play=function(){_play.call(this)},_ns[e].triggers.pause=function(){_pause.call(this)},_ns[e].triggers.toggle=function(){_toggle.call(this)},_ns[e].triggers.toggleFullScreen=function(){_toggleFullScreen.call(this)},_ns[e].triggers.transitionEnd=function(){this.transitioning=!1,this.options.touchSwipe||_load.call(this),_startPlaybackTimer.call(this),this.contentContainer.trigger(this.triggered="transitionend",{dom:this.current,data:this.currentData}),this.contentContainer.trigger(this.triggered="item",{dom:this.current,data:this.currentData})},_ns[e].triggers.videoReady=function(){this.current.find(".video-overlay").show()},_ns[e].triggers.videoStart=function(){this.current.find(".video-overlay").hide(),_pause.call(this),this.current.find(".video-container").css({left:0,top:0,margin:0,width:"100%",height:"100%",opacity:1}).data("resume","playing"===this.state),this.contentContainer.trigger(i.triggered="videobegin")},_ns[e].triggers.videoPause=function(){this.current.find(".video-overlay").show(),this.currentData.html?this.current.find(".video-container").css({top:"50%",left:"50%",width:"50px",height:"50px",margin:"-25px 0 0 -25px",opacity:.001}):this.current.find(".video-container").css("left",-1e4),this.contentContainer.trigger(i.triggered="videopause")},_ns[e].triggers.videoEnd=function(){this.current.find(".video-container").data("resume")&&(_update.call(this,1),this.state="playing"),this.contentContainer.trigger(i.triggered="videoend")},n&&$.each(n,function(t,n){_ns[e].options.hasOwnProperty(t)||(_ns[e].options[t]=n)}),_ns[e]},P.init=function(t,n){var i=_setup(t,n),e={context:i.context,options:$.extend({},i.options),on:function(t,n){var e=[];return $.each(t.split(" "),function(t,n){RegExp("^|\\s"+n+"\\s|$").test(_handles)&&e.push(n)}),e.length&&$.each(e,function(t,e){i.handlers.push(e),_bind.call(i,{type:e,fn:n})}),this},off:function(t){i.container.unlisten(t)},kill:function(){_kill.call(i)},play:function(){_play.call(i)},pause:function(){_pause.call(i)},next:function(){_update.call(i,1)},options:function(){return _options.call(i)},previous:function(){_update.call(i,-1)},toggle:function(){_toggle.call(i)},toggleFullscreen:function(){Pulse.fullScreenApi.supportsFullScreen&&_toggleFullScreen.call(i)},loadItem:function(t){_loadItemById.call(i,t)},loadItemAtPosition:function(t){_loadItemByIndex.call(i,t)},restart:function(){_loadItemByIndex.call(i,0,!0)},getItem:function(){return _getItem.call(i)},getNextItem:function(){return _getNextItem.call(i)},trigger:function(t){return i.dead?void 0:(i.triggers[t]?i.triggers[t].call(i):i.contentContainer.trigger(i.triggered=t,i.contentContainer),this)},ratio:function(t){return _ratio.call(i,t,!0)},append:function(t){t.css("position").length<=0&&t.css("position","relative"),t.css("zIndex",12),this.context.find(".pulse-main-container").append(t)},queue:function(){return _queue.call(i,!0)},clone:function(t){return _clone.call(i,t)}};i.options.touchSwipe?(Pulse.transitions._swipe.call(e,i.options),i.options.transition_duration="500ms"):Pulse.transitions[i.options.transition]?Pulse.transitions[i.options.transition].call(e,i.options):Pulse.transitions.dissolve.call(e,i.options);for(var o in window.Pulse.plugin)e[o]=window.Pulse.plugin[o];return $(function(){if(i.contentContainer.trigger(i.triggered="start",i.container),i.options.data&&i.options.data.content){var t={content:i.options.data.content,total:i.options.data.content.length,page:1,pages:1};_data.call(i,t)}else _data.call(i)}),e}}return P.init}.call({});window.Pulse.plugin={},window.Pulse.transitions={_swipe:function(t){var n=!1;this.on("transition",function(i){var e,o=i.next.parents(".pulse-touch-container");i.current&&i.next.attr("data-pulse-container")===i.current.attr("data-pulse-container")?(e=0,t.transition_duration="200ms"):e=o.width(),n||(i.next.css({left:e,opacity:1}),t.transition_duration="1ms",n=!0),i.forward&&(e=-e),o.css(t.touchSwipePrefix+"transition",t.touchSwipePrefix+"transform "+t.transition_duration+" ease-out"),requestAnimationFrame(function(){o.css(t.touchSwipePrefix+"transform","translate3d("+e+"px,0,0)")})})},none:function(){var t=this;this.on("transition",function(n){n.current&&n.current.css({opacity:0}),n.next.css({opacity:1}),t.trigger("transitionEnd")})},dissolve:function(t){var n=this;this.on("transition",function(i){i.current&&i.current.animate({opacity:0},{duration:t.transition_duration}),i.next.animate({opacity:1},{duration:t.transition_duration,complete:function(){n.trigger("transitionEnd")}})})},fade:function(t){var n=this;this.on("transition",function(i){i.current?i.current.animate({opacity:0},{duration:t.transition_duration/2,complete:function(){i.next.animate({opacity:1},{duration:t.transition_duration/2,complete:function(){n.trigger("transitionEnd")}})}}):i.next.animate({opacity:1},{duration:t.transition_duration,complete:function(){n.trigger("transitionEnd")}})})},slide:function(t){var n=this;this.on("transition",function(i){var e=n.context,o=n.clone(i.next),s=n.clone(i.current),a=e.width(),r=!1,l=$("<div/>").css({width:"100%",height:"100%",top:0,left:0,position:"absolute",overflow:"hidden"}),c=$("<div/>").css({width:2*a,height:"100%",top:0,left:i.forward?0:"-"+a+"px",position:"relative"}).appendTo(l),u=function(){i.next.css({opacity:1}),l.remove(),n.trigger("transitionEnd")},h=["Webkit","Moz","O","ms",""],d=!1;h.forEach(function(t){return t+"Transform"in document.body.style?(d=t,!1):void 0}),d&&(d.length&&(d="-"+d.toLowerCase()+"-"),c.css(d+"transition",d+"transform "+t.transition_duration+"ms "+t.transition_easing),r=!0),s&&(i.forward||s.css({left:a+"px"}),c.append(s)),o.css({opacity:1}),i.forward&&o.css({left:a+"px"}),c.append(o),n.append(l),window.setTimeout(function(){return i.current?("fill"!==n.options.crop&&i.current.css({opacity:0}),requestAnimationFrame(function(){a=i.forward?"-"+a:a,r?(c.bind("webkitTransitionEnd mozTransitionEnd msTransitionEnd oTransitionEnd transitionend",u),c.css(d+"transform","translate3d("+a+"px,0,0)")):c.animate({left:a},{duration:t.transition_duration,easing:t.transition_easing,complete:u})}),void 0):(u(),void 0)},i.current?50:250)})}},window.Pulse.register_transition=function(t){window.Pulse.transitions=$.extend(window.Pulse.transitions,t)},function(){var t={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},n="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)t.supportsFullScreen=!0;else for(var i=0,e=n.length;e>i;i++)if(t.prefix=n[i],"undefined"!=typeof document[t.prefix+"CancelFullScreen"]){t.supportsFullScreen=!0;break}t.supportsFullScreen&&(t.fullScreenEventName=t.prefix+"fullscreenchange",t.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},t.requestFullScreen=function(t){return""===this.prefix?t.requestFullScreen():t[this.prefix+"RequestFullScreen"]()},t.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}),Pulse.fullScreenApi=t}();